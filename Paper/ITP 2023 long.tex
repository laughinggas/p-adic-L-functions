\documentclass[a4paper,UKenglish,cleveref, autoref, thm-restate]{lipics-v2021}
%This is a template for producing LIPIcs articles. 
%See lipics-v2021-authors-guidelines.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling autoref support, use "autoref"
%for anonymousing the authors (e.g. for double-blind review), add "anonymous"
%for enabling thm-restate support, use "thm-restate"
%for enabling a two-column layout for the author/affilation part (only applicable for > 6 authors), use "authorcolumns"
%for producing a PDF according the PDF/A standard, add "pdfa"

%\pdfoutput=1 %uncomment to ensure pdflatex processing (mandatatory e.g. to submit to arXiv)
%\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

\title{Formalisation of $p$-adic $L$-functions in Lean 3} %TODO Please add

\titlerunning{$p$-adic $L$-functions} %TODO optional, please use if title is longer than one line

\author{Ashvni Narayanan}{London School of Geometry and Number Theory}{a.narayanan20@imperial.ac.uk}{https://orcid.org/0000-0003-2777-4228}{EPSRC Grant EP/S021590/1 (UK)}%TODO mandatory, please use full name; only 1 author per \author macro; first two parameters are mandatory, other parameters can be empty. Please provide at least the name of the affiliation and the country. The full address is optional. Use additional curly braces to indicate the correct name splitting when the last name consists of multiple name parts.

%\author{Joan R. Public\footnote{Optional footnote, e.g. to mark corresponding author}}{Department of Informatics, Dummy College, [optional: Address], Country}{joanrpublic@dummycollege.org}{[orcid]}{[funding]}

\authorrunning{A. Narayanan} %TODO mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{Ashvni Narayanan} %TODO mandatory, please use full first names. LIPIcs license is "CC-BY";  http://creativecommons.org/licenses/by/3.0/

\ccsdesc[500]{Mathematics of computing~Mathematical software} %TODO mandatory: Please choose ACM 2012 classifications from https://dl.acm.org/ccs/ccs_flat.cfm 
\ccsdesc[300]{Theory of computation~Formal languages and automata theory}

\keywords{formal math, algebraic number theory, Lean, mathlib} %TODO mandatory; please add comma-separated list of keywords

%\category{} %optional, e.g. invited paper

%\relatedversion{} %optional, e.g. full version hosted on arXiv, HAL, or other respository/website
%\relatedversiondetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93]{Classification (e.g. Full Version, Extended Version, Previous Version}{URL to related version} %linktext and cite are optional

\supplement{Copies of the source files relevant to this paper are available in a separate repository.}%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...
\supplementdetails[swhid={}]{Software}{https://github.com/laughinggas/p-adic-L-functions} %linktext, cite, and subcategory are optional

%\funding{(Optional) general funding statement \dots}%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.

\acknowledgements{The author is supported by EPSRC. The author would like to thank her PhD supervisor Prof Kevin Buzzard for several helpful insights. 
She would also like to thank Dr Filippo A. E. Nuccio for helpful conversations that helped give shape to the project. She is very grateful 
to the entire Lean community for their timely help and consistent support.}%optional

%\nolinenumbers %uncomment to disable line numbering



%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{John Q. Open and Joan R. Access}
\EventNoEds{2}
\EventLongTitle{42nd Conference on Very Important Topics (CVIT 2016)}
\EventShortTitle{CVIT 2016}
\EventAcronym{CVIT}
\EventYear{2016}
\EventDate{December 24--27, 2016}
\EventLocation{Little Whinging, United Kingdom}
\EventLogo{}
\SeriesVolume{42}
\ArticleNo{23}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{hyperref}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{xspace}
\usepackage{listings}
%\usepackage{minted}
\def\lstlanguagefiles{lstlean.tex}
\lstset{language=lean}
%\bibliographystyle{plainurl}

\addtolength{\oddsidemargin}{-.875in}
\addtolength{\evensidemargin}{-.875in}
\addtolength{\textwidth}{1.75in}

\definecolor{keywordcolor}{rgb}{0.7, 0.1, 0.1}   % red
\definecolor{commentcolor}{rgb}{0.4, 0.4, 0.4}   % grey
\definecolor{symbolcolor}{rgb}{0.4, 0.4, 0.4}    % grey
\definecolor{sortcolor}{rgb}{0.1, 0.5, 0.1}      % green

\newcommand{\C}{\mathbb{C}}
\newcommand{\lean}[1]{\texttt{#1}\xspace} % for writing Lean expressions
\newcommand*{\OK}[1][K]{\mathcal{O}_{#1}}
\newcommand*{\Cl}{\mathcal{C}\kern-.075em l}
% \DeclareMathOperator{\Cl}{Cl}
\newcommand*{\Fq}[1][q]{\mathbb{F}_{#1}}
\DeclareMathOperator{\Tr}{Tr}
\newcommand{\mathlib}{\textsf{mathlib}\xspace}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\pow}{\textasciicircum\xspace}
\newcommand{\Q}{\mathbb{Q}}
% \newcommand{\Qbar}{\mathbb{\bar{Q}}}
\newcommand{\Z}{\mathbb{Z}}
\DeclareMathOperator{\Frac}{Frac}

\DeclareUnicodeCharacter{21D1}{\ensuremath{\Uparrow}}
\DeclareUnicodeCharacter{2194}{\ensuremath{\longleftrightarrow}}
\DeclareUnicodeCharacter{1D4DD}{\ensuremath{\mathcal{N}}}
\DeclareUnicodeCharacter{22C3}{\ensuremath{\bigcup}}
\DeclareUnicodeCharacter{03BB}{\ensuremath{\lambda}}
\DeclareUnicodeCharacter{03B1}{\ensuremath{\alpha}}
\DeclareUnicodeCharacter{03C3}{\ensuremath{\sigma}}
\DeclareUnicodeCharacter{03C7}{\ensuremath{\chi}}
\DeclareUnicodeCharacter{2081}{\ensuremath{_1}}
\DeclareUnicodeCharacter{2082}{\ensuremath{_2}}
\DeclareUnicodeCharacter{2090}{\ensuremath{_a}}
\DeclareUnicodeCharacter{2097}{\ensuremath{_l}}
\DeclareUnicodeCharacter{211A}{\ensuremath{\Q}}
\DeclareUnicodeCharacter{2124}{\ensuremath{\Z}}
\DeclareUnicodeCharacter{2115}{\ensuremath{\N}}
\DeclareUnicodeCharacter{2211}{\ensuremath{\sum}}
\DeclareUnicodeCharacter{2264}{\ensuremath{\l}}
\DeclareUnicodeCharacter{2286}{\ensuremath{\subseteq}}
\DeclareUnicodeCharacter{22A4}{\ensuremath{\top}}
\DeclareUnicodeCharacter{22A5}{\ensuremath{\bot}}
\DeclareUnicodeCharacter{2243}{\ensuremath{\simeq}}
\DeclareUnicodeCharacter{2080}{\ensuremath{_0}}
\DeclareUnicodeCharacter{03C8}{\ensuremath{\psi}}
\DeclareUnicodeCharacter{2225}{\ensuremath{\lVert}}
\DeclareUnicodeCharacter{2A06}{\ensuremath{\bigsqcup}}
\DeclareUnicodeCharacter{02E3}{\ensuremath{^{\times}}}
\DeclareUnicodeCharacter{03B5}{\ensuremath{\varepsilon}}
\DeclareUnicodeCharacter{2203}{\ensuremath{\exists}}
\DeclareUnicodeCharacter{2200}{\ensuremath{\forall}}
\DeclareUnicodeCharacter{2265}{\ensuremath{\ge}}
\DeclareUnicodeCharacter{1DA0}{\ensuremath{^{\texttt{f}}}}
%\newunicodechar{^}{\ensuremath{\textasciicircum}}

\renewcommand\UrlFont{\color{blue}\rmfamily}

\begin{document}

\maketitle

%TODO mandatory: add short abstract of the document
\begin{abstract}
This paper decribes formalisation of $p$-adic $L$-functions in an interactive theorem prover Lean 3. $p$-adic 
$L$-functions are fundamental number theoretic objects. These special functions emerge from the special 
values they take at negative integers in terms of generalized Bernoulli polynomials. We formalise their 
definition in terms of a $p$-adic integral with respect to the Bernoulli measure, and prove that they 
take the required values at negative integers.
\end{abstract}

\section{Introduction}
I am working on formalising mathematics in an interactive theorem prover called Lean. 
Formal verification involves the use of logical and computational methods to establish 
claims that are expressed in precise mathematical terms \cite{TPIL}. Lean is a powerful tool 
that facilitates formalisation of a system of mathematics supported by a basic set of axioms. There is a large mathematical library of theorems verified by Lean called \lean{mathlib}, maintained by a community of computer scientists and mathematicians. One can then 
formally verify proofs of new theorems dependent on preexisting theorems in \lean{mathlib}. 
\lean{mathlib} currently contains 100579 theorems(as of early October 2022). It would be impossible to construct 
such a vast library without a highly collaborative spirit and a communal decentralized effort, one of 
Lean's best features. \\
%% explain more about how mathlib works
I am working towards formalising the statement of the Iwasawa Main Conjecture.
The statement unifies an ``algebraic side", coming from characteristic polynomials,
with an ``analytic side", coming from $p$-adic $L$-functions. This article focuses on the 
formalisation of $p$-adic $L$-functions in Lean. This has never been done before in any 
theorem prover. As a result, one needs to build a lot of background (in the maximum possible generality) 
before embarking on the main goal. The project is complete. \\

$p$-adic $L$-functions are a very well studied number theoretic object. They were initially constructed 
by Kubota and Leopoldt in \cite{KL}. Their motivation was to construct a meromorphic function that helps study 
the Kummer congruence for Bernoulli numbers, and gives information regarding $p$-adic class numbers. 
%%They appear in several places, such as the Birch and Swinnerton-Dyer Conjecture. 
As a result, these functions take twisted values of the Dirichlet $L$-function at negative integers, and 
are also related to the generalized Bernoulli numbers and the $p$-adic zeta function. \\

There are several different ways of constructing $p$-adic $L$-functions. I refer to the constructions
given in Chapter 12 of \cite{cyc}. An optimal definition is one that minimizes the amount of code needed 
to obtain the required properties, and that is the ``most general", so that it can be used to its full 
potential. I have chosen a definition in terms of $p$-adic integrals because it seems to be the
closest to what I need for stating the Iwasawa Main Conjecture. Moreover, it minimizes the
code needed to show analytic continuity of several functions that would be needed in other definitions. \\

The following tools are needed to construct $p$-adic $L$-functions: Bernoulli numbers and polynomials, locally compact Hausdorff totally
disconnected spaces, and the $p$-adic integers and its topological properties.
I introduce these, and then define the $p$-adic $L$-function, finishing with a summary of what has been
accomplished and what will be. \\

All the code discussed in this article can be found on the branch $p$-adic\footnote{\url{https://github.com/leanprover-community/mathlib/tree/p-adic}}. 
The most current version of \lean{mathlib} (which is not the one I am using) is \cite{mathlib}.

\subsection{Mathematical overview}
We shall give a brief overview of the mathematics formalised in this project. 
$L$-functions are a fundamental object, appearing almost everywhere in modern 
number theory. There are several types of $L$-functions. The $L$-function attached 
to an elliptic curve gives information about its rank. The Dirichlet $L$-function 
associated to a character $\chi$ is given by  
$$ L(s, \chi) = \sum_{n = 1}^{\infty} \frac{\chi (n)}{n^s} = \prod_{p \text{ prime}} \frac{1}{1 - \chi (p) p^{-s}}$$
where $s$ is a complex variable with $Re(s) > 1$. This can be analytically extended 
to the entire complex plane, with a simple pole at $s = 1$ when $\chi = 1$. Note also 
that $L(s, 1)$ is the same as the Reimann zeta function. Moreover, it is known that 
$L(1 - n, \chi) = - \frac{B_{n, \chi}}{n}$, where $B_{n, \chi}$ are the generalized 
Bernoulli numbers. \\

In this paper, we try to construct, for an integer prime $p$, a $p$-adic analogue of $L(s, \chi)$, 
called the Kubota-Leopoldt $p$-adic $L$-function, denoted $L_p(s, \chi)$. We fix, for the rest 
of this paper, a prime $p$. This is generally done by continuously extending the function 
$L_p(1 - n, \chi) := (1 - \chi (p) p^{n - 1}) L(1 - n, \chi)$ to the $p$-adic integers, 
$\mathbb{Z}_p$. In fact, $L_p(s, 1)$ is analytic except for a pole at $s = 1$ with residue 
$1 - \frac{1}{p}$ (Theorem 5.11, Washington). \\

Due to several reasons explained in the following sections, formalisation of the $p$-adic 
$L$-functions via analytic continuation would be hard. Thus, we chose to formalise it in 
as a measure theoretic object. Following Washington, we define it in terms of a 
"$p$-adic integral" with respect to the Bernoulli measure. We shall explain these terms below. \\

A profinite space is a compact, Hausdorff and totally disconnected space. The $p$-adic integers 
$\mathbb{Z}_p$, which are the completion of the integers $\mathbb{Z}$ with respect to the 
valuation $\nu_p(p^{\alpha} \prod_{p_i \ne p} p_i^{\alpha_i}) = \alpha$ are a profinite space. 
One may also think of them as the inverse limit of the discrete topological spaces 
$\mathbb{Z} / p^{n} \mathbb{Z}$, that is, $\mathbb{Z}_p = \projlim_{n} \mathbb{Z} / p^{n} \mathbb{Z}$. 
This is equivalent to saying that there are surjective maps $\phi_n : \mathbb{Z}_p \xrightarrow[]{} \mathbb{Z} / p^{n} \mathbb{Z}$, 
such that .... 
A corollary of this is that $\mathbb{Z}_p$ has a topological basis of clopen sets (both open and closed), 
$(U_{a, n})_{(a, n)}$ for $n \in \mathbb{N}$ and $a \in \mathbb{Z} / p^{n} \mathbb{Z}$, 
where $U_{a, n} := \{ x \in \mathbb{Z}_p | x \equiv a (\text{mod } p^n) \}$. \\

Given a profinite space $X$ and a normed ring (?) $R$, one can show that the locally constant 
functions (preimage of any set is open) from $X$ to $R$ (denoted $LC(X, R)$) are dense in the space of continuous 
functions from $X$ to $R$ (denoted $C(X, R)$). \\

Given an abelian group $A$, a distribution is defined to be an $A$-linear map from $LC(X, A)$ 
to $A$. A $p$-adic measure $\phi$ is defined to be a bounded distribution, that is, $\forall f \in LC(X, R)$, 
$\exists K > 0$ such that $|| \phi (f) || \le K ||f|| $, where $||f|| = \sup_{x \in X} || f(x)||$. 
An example of a $p$-adic measure is a Bernoulli measure. Given a clopen set $U_{a, n}$ of $\mathbb{Z}_p$, 
the characteristic function $\chi_{a, n}$ (defined to be 1 on $U_{a,n}$ and 0 otherwise) is a locally constant function. 
We then define the Bernoulli measure $E_c$ to be :
$$ E_c(U_{a, n}) := ... $$
We shall show later that this is sufficient to define $E_c$ on all locally constant functions, and that 
$E_c$ is indeed a measure. Given a $p$-adic measure $\mu$, we define the $p$-adic integral with respect 
to $\mu$ to be $\int f d\mu := \mu (f)$. Since $LC(X, R)$ is dense in $C(X, R)$, we can then extend the 
definition of the $p$-adic integral to $C(X, R)$. In fact, this is an $R$-linear map. \\

Finally, the $p$-adic $L$-function is defined to be a $p$-adic integral with respect to the Bernoulli 
measure. 

The characterizing property of the $p$-adic $L$-function is its evaluation at negative integers. If defined as an 
analytic continuation, this would follow directly. However, when defined as a $p$-adic integral, additional work is 
needed to prove this. The equivalence of these two definitions is proved in Theorem 12.2 of Washington. The same theorem 
also helps show the independence of the theorem from the additional variable $c$.

In this paper, we formalise this definition of the $p$-adic $L$-function and prove its values at negative integers in terms of 
the generalized Bernoulli numbers. Moreover, this is done in generality, taking values in a normed complete $\mathbb{Q}_p$-algebra, 
instead of just $\mathbb{C}_p$.
\subsection{Lean and \lean{mathlib}}
Lean 3 is a functional programming language and interactive theorem prover based on
dependent type theory, with proof irrelevance and non-cumulative universes. For an
introduction to Lean, see for instance . \\

This project is based on Lean‚Äôs mathematical library mathlib, which is characterized by
its decentralized nature with over 300 contributors. Due to the distributed organization of
mathlib, it is impossible to cite every author who contributed a piece of code that we used.
However, we remark that our formalisation makes extensive use of the theory of Dedekind
domains and of the theory of uniform spaces and completions, originally developed in the
perfectoid space formalisation project. \\

In Lean‚Äôs core library and mathlib, type classes are used to handle mathematical
structures on types. For example, the type class ring packages two operations, addition and
multiplication, as well as a list of properties they must satisfy. Then, given a type R, we can
declare an instance [ring R], and Lean‚Äôs instance resolution procedure will infer that R has
a ring structure. Besides instance, whose behaviour we have just described, we use in this
paper the keywords variables, def, lemma and theorem, which have the evident meaning.

In this section, we define some fundamental concepts which shall be used throughout this article. In a lot of these cases, 
the Lean definition is far more generalized (and hence different) than the usual mathematical definition. However, there is 
always a database of theorems associated to a definition, which connect it to the usual mathematical definition. So 
we sometimes skip the Lean definition and instead explain a theorem/lemma that shows an equivalence of the Lean definition with the mathematical one. \\

%%The following definitions are used throughout this section : \\
%%Note that, in Lean, a topological space is a term of a type, and is not automatically identified as a 
%%set. However, it can contain subsets, and \lean{univ} denotes the universal set, or the space itself. \\
A subset $s$ of a topological space has the property \lean{is\_compact} if for every filter $f$ containing 
$s$, there exists $a \in s$ such that $a$ is a limit point of $f$. This technical definition 
is not very easy to work with. Instead, we use the following lemma that gives an (equivalent) definition : 
\begin{lstlisting}
  lemma is_compact.elim_finite_subcover 
  {Œ± : Type u} [_inst_1 : topological_space Œ±] {s : set Œ±} {Œπ : Type v} 
  (hs : is_compact s) (U : Œπ ‚Üí set Œ±) 
  (hUo : ‚àÄi, is_open (U i)) (hsU : s ‚äÜ ‚ãÉ i, U i) :
  ‚àÉ t : finset Œπ, s ‚äÜ ‚ãÉ i ‚àà t, U i
\end{lstlisting}
This lemma states that a subset $s$ of a topological space is \textit{compact} if for every cover $s \subseteq \cup_{i} U_i$
of $s$ by open sets $U_i$, there exists a finite subcover $U_1, \dots, U_m$ such that
$s \subseteq \cup_{i = 1}^m U_i$. A \lean{compact\_space} is a topological space which satisfies the property 
\lean{is\_compact} when thought of as a set : 
\begin{lstlisting}
class compact_space (Œ± : Type*) [topological_space Œ±] :=
(compact_univ : is_compact (univ : set Œ±))
\end{lstlisting}

Note that, in Lean, a topological space is a term of a type, and is not automatically identified as a 
set. However, it can contain subsets, and \lean{univ} denotes the universal set, or the topological space, 
thought of as a subset of itself. The difference between \lean{is\_compact univ} and \lean{compact\_space $\alpha$} is subtle : 
\lean{is\_compact} takes as input a term of a type (which is not a type), while \lean{compact\_space} 
takes as input a type. These distinctions are a consequence of Lean being based on type theory, instead of set theory. \\

A topological space $X$ is a \textit{locally compact space} if  for every element $x$ of $X$, 
every neighbourhood $n$ of $x$(a set containing an open set containing $x$) contains a compact 
neighbourhood of $x$ :
\begin{lstlisting}
  class locally_compact_space (Œ± : Type*) [topological_space Œ±] : Prop := 
  (local_compact_nhds : ‚àÄ (x : Œ±) (n ‚àà ùìù x), ‚àÉ s ‚àà ùìù x, s ‚äÜ n ‚àß is_compact s)
\end{lstlisting}
%%For a Hausdorff topological space $X$, this is equivalent to is called \textit{locally compact} if for every $x \in X$, there
%%exists a compact neighbourhood $z$ containing $x$. \\

A set $s$ of a topological space is \textit{totally separated} if it has the property \lean{is\_totally\_separated} : 
$\forall x, y \in s$ with $x \ne y$, there exist disjoint open sets $U, V$ such that $x \in U$, $y \in V$, and
$s \subseteq U \cup V$ : 
\begin{lstlisting}
  def is_totally_separated {Œ± : Type u} [topological_space Œ±] (s : set Œ±) : Prop :=
‚àÄ x ‚àà s, ‚àÄ y ‚àà s, x ‚â† y ‚Üí ‚àÉ u v : set Œ±, is_open u ‚àß is_open v ‚àß x ‚àà u ‚àß y ‚àà v ‚àß s ‚äÜ u ‚à™ v ‚àß u ‚à© v = ‚àÖ
\end{lstlisting}
A topological space is \lean{totally\_separated} if the universal set of the space \lean{univ} 
satisfies \lean{is\_totally\_separated}. \\
%%Should I do the same for tot disc?
A set $s$ of a topological space is called \textit{totally disconnected} if it satisfies \lean{is\_totally\_disconnected} : 
Every subset which has no non-trivial open partition is atmost a singleton. A topological space is \lean{totally\_disconnected} if it is
totally disconnected as a subset of itself. An equivalent statement is, A space is totally disconnected iff its connected components are singletons :
\begin{lstlisting}
lemma totally_disconnected_space_iff_connected_component_singleton 
{Œ± : Type u} [topological_space Œ±] :
  totally_disconnected_space Œ± ‚Üî ‚àÄ x : Œ±, connected_component x = {x}
\end{lstlisting} 

A \textit{profinite} space is a compact Hausdorff space which is totally disconnected :
\begin{lstlisting}
structure Profinite :=
(to_CompHaus : CompHaus)
[is_totally_disconnected : totally_disconnected_space to_CompHaus]
\end{lstlisting}

%%It is also an inverse limit of finite spaces. \\

A function on a topological space satisfies \lean{is\_locally\_constant} if the preimage of every set is open : 
\begin{lstlisting}
def is_locally_constant {X Y : Type*} [topological_space X] (f : X ‚Üí Y) : Prop := 
‚àÄ s : set Y, is_open (f ‚Åª¬π' s)
\end{lstlisting} 

Lean has \lean{locally\_constant X Y}, which is a type of functions bundled with the property 
\newline \lean{is\_locally\_constant} :
\begin{lstlisting}
structure locally_constant (X Y : Type*) [topological_space X] :=
(to_fun : X ‚Üí Y)
(is_locally_constant : is_locally_constant to_fun)
\end{lstlisting}
A term \lean{f'} of type \lean{locally\_constant X A}, looks like \lean{f' = ‚ü®f, hf‚ü©}, where 
\lean{f} is the function \lean{f:X ‚Üí A}, and \lean{hf} is a proof that \lean{f} is locally constant, 
that is, \lean{hf:is\_locally\_constant f}. 
For this article, we use the notation $LC(X, A)$ to denote the set of locally constant functions 
from $X$ to $A$. \\

Similarly, the type of \textit{continuous functions} on topological spaces $\alpha \to \beta$, 
denoted $C(\alpha, \beta)$ here and \lean{C($\alpha, \beta$)} in Lean, is defined as :
\begin{lstlisting}
structure continuous_map (Œ± : Type*) (Œ≤ : Type*) 
  [topological_space Œ±] [topological_space Œ≤] :=
(to_fun             : Œ± ‚Üí Œ≤)
(continuous_to_fun  : continuous to_fun)
\end{lstlisting}
%%I define the canonical (linear) injection \lean{inclusion : LC(X,A) ‚Üí C(X, A)}. \\

A \textit{clopen set} of a topological space is a set which is both open and closed. This property is given by \lean{is\_clopen}. 
There is a subtype of clopen sets :
\begin{lstlisting}
  def clopen_sets (H : Type*) [topological_space H] := 
  {s : set H // is_clopen s}
\end{lstlisting}

Given \lean{U:clopen\_sets X} for a topological space \lean{X}, \lean{U.val} is the set, and has type \lean{set H}, and \lean{U.prop} holds the property satisfied by 
\lean{U}, that is, \lean{U.prop:is\_clopen U}. \\

The \textit{characteristic function} of \lean{U} on \lean{X}, \lean{char\_fn X U}, takes value 1
for every element of \lean{U}, and 0 otherwise. Characteristic functions of clopen sets are locally
constant : 
\begin{lstlisting}
  def char_fn {R : Type*} [topological_space R] [ring R] [topological_ring R]
  (U : clopen_sets X) : locally_constant X R := 
  { to_fun := Œª x, by classical; exact if (x ‚àà U.val) then 1 else 0,
    is_locally_constant := _ } 
\end{lstlisting} 
%% topo ring strong condition?

A \textit{Dirichlet character mod $n$} is a multiplicative group homomorphism 
$(\mathbb{Z}/n\mathbb{Z})^{\times} \xrightarrow[]{} \mathbb{C}^{\times}$. This induces a Dirichlet 
character mod $kn$ for all $k > 0$. The smallest such $n$ is called the \textit{conductor} of the character. 
A Dirichlet character mod $n$ is called \textit{primitive} if it has conductor $n$. In this article, all 
Dirichlet characters are assumed to be primitive. \\

For a \lean{topological\_group} A, define the \textit{weight space}, denoted \lean{weight\_space}, to be the
continuous monoid homomorphisms from
$(\mathbb{Z}/d\mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times}$ to $A^{\times}$, with $gcd(d,p) = 1$ : 
\begin{lstlisting}
  structure weight_space extends monoid_hom ((units (zmod d)) √ó (units ‚Ñ§_[p])) A,
    C((units (zmod d)) √ó (units ‚Ñ§_[p]), A)
\end{lstlisting}

One of the aspects of defining $p$-adic $L$-functions in Lean is to understand its type. In \cite{cyc}, 
it takes values from a subset of $\mathbb{C}_p$ (the $p$-adic completion of the algebraic closure of 
the fraction field of $\mathbb{Z}_p$) and Dirichlet characters. Since $\mathbb{C}_p$ 
has not been defined in Lean yet, my attempt has been to find a space to replace it. According to 
this construction, the domain can be replaced with the product of the weight space and the space of 
Dirichlet characters. The range is contained in a commutative and complete normed ring with a 
coercion from $\mathbb{Z}_p$, which is denoted by $R$.
%%The fraction field of $\mathbb{Z}_p$ is denoted $\mathbb{Q}_p$.
%%The $p$-adic completion of the algebraic closure of $\mathbb{Q}_p$ is denoted $\mathbb{C}_p$, and it
%%is topologically and algebraically closed. Most authors prefer to work with $\mathbb{C}_p$. In fact, 
%%$p$-adic $L$-functions defined in \cite{cyc} take values in $\mathbb{C}_p$.

\section{Preliminaries}
\subsection{Modular arithmetic and $\mathbb{Z}_p$}
Some fundamental objects with which we shall work throughout are the finite spaces $\mathbb{Z}/n \mathbb{Z}$ for all $n \in \mathbb{N}$. Given $n \in \mathbb{N}$, 
$\mathbb{Z}/n \mathbb{Z}$ is the same as \lean{fin n}, the set of natural numbers upto $n$. This has a natural group structure, and is given the discrete topology, 
making it a topological group. Some of the maps used constantly include \lean{val:zmod n ‚Üí ‚Ñï}, which takes any element to its smallest reprentative in the equivalence class, 
and \lean{cast\_hom:zmod n ‚Üí R}, a coercion to a ring, obtained by composing the canonical coercion with \lean{val}. If $R$ has characteristic 
dividing $n$, the map is a ring homomorphism. Given $m, n \in \mathbb{N}$ with $m$ and $n$ coprime, an important equivalence is given by the Chinese Remainder Theorem : 
\lean{chinese\_remainder:zmod (m * n) ‚âÉ+* zmod m √ó zmod n}. About 30 additional lemmas were required, which have been put in a separate file, \lean{zmod\_properties.lean}. \\

%%The \textit{$p$-adic valuation} is a function $\nu_p : \mathbb{Z} \xrightarrow[]{} \mathbb{R}$, such that
%%$\nu_p (p^k) = k$, and for $gcd(a,p) = 1$, $\nu_p (a) = 0$. By convention,$\nu_p (0) = \infty$, however, in Lean, \lean{valuation 0 = 0 }.
For this article, we shall assume $p$ denotes a prime and $d$ is a positive natural with 
$gcd (d, p) = 1$. The \textit{ring of $p$-adic integers}, denoted \lean{$\mathbb{Z}$\_[p]}, is the completion of $\mathbb{Z}$ by the $p$-adic
valuation. It has the following properties :
\begin{itemize}
  \item As a profinite limit, $\mathbb{Z}_p = \varprojlim \mathbb{Z} / p^n \mathbb{Z}$. As a result,
  one can find (compatible) surjective ring homomorphisms \lean{to\_zmod\_pow : ‚Ñ§\_[p] ‚Üí+* zmod (p\textasciicircum n)} for all $n \in \mathbb{N}$.
  \item As a topological space, $\mathbb{Z}_p$ has the profinite topology, induced by discrete topology
  on the finite sets $\mathbb{Z} / p^n \mathbb{Z}$. Hence, $\mathbb{Z}_p$ is a compact, Hausdorff totally disconnected space
  with a clopen basis of the form $a + p^n \mathbb{Z}_p$, with $a \in \mathbb{Z} / p^n \mathbb{Z}$ for
  every $n$.
  \item For $p > 2$, $\mathbb{Z}_p^{\times} ‚âÉ (\mathbb{Z}/p \mathbb{Z})^{\times} \times (1 + p \mathbb{Z}_p)$\footnote{$\mathbb{Z}_2^{\times} \cong \{ \pm 1 \} \times (1 + 4 \mathbb{Z}_2)$}.
  By the Chinese Remainder Theorem, we have, for $gcd(d, p) = 1$,
  $(\mathbb{Z}/d\mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times} ‚âÉ
  (\mathbb{Z}/dp \mathbb{Z})^{\times} \times (1 + p \mathbb{Z}_p)$
\end{itemize}

These properties characterize the $p$-adic integers, and are integral to this work. While some preexisted in 
\lean{mathlib}, about 40 additional lemmas have been proved in \lean{padic\_int\_properties.lean}. 
Moreover, lots of facts regarding the clopen basis given above have been utilized and proved in \lean{padic\_int\_clopen\_properties.lean}. (add links)

\subsection{Dirichlet characters and the Teichm√ºller character}
An important task was to formalise Dirichlet characters and its properties. They are an integral part of the definition of the $p$-adic $L$-function. 
The Teichm√ºller character, especially, plays a significant role. This is novel, in the sense that Dirichlet characters are often not found to be defined 
in this technical manner in most texts. Another addition is the definition of Dirichlet characters of level and conducor 0. We also generalize the 
definition from group homomorphisms to $\mathbb{C}$ to monoid homomorphisms on any \lean{comm\_monoid\_with\_zero}. 
In this section, the words character and Dirichlet character are used interchangeably. \\

The Dirichlet characters are usually defined as group homomorphisms from $\mathbb{Z}/n \mathbb{Z}$ to $\mathbb{C}$ for some natural number $n$. 
We can then assign levels to Dirichlet characters and relate Dirichlet characters of different levels, constructing a "compatible" system of 
characters for certain values of $n$. \\

For any two monoids $M$ and $M'$, \lean{M ‚Üí* M'} denotes the type of monoid homomorphisms from $M$ to $M'$. Thus, making a separate 
\lean{def} for Dirichlet characters does not make sense. Instead, we use :
\begin{lstlisting}
  abbreviation dirichlet_character (R : Type*) [monoid R] (n : ‚Ñï) := 
    units (zmod n) ‚Üí* units R
  abbreviation lev {R : Type*} [monoid R] {n : ‚Ñï} (œá : dirichlet_character R n) : 
    ‚Ñï := n
\end{lstlisting}

In other words, given a monoid $R$, the space of Dirichlet characters of level $n$ is the space of monoid homomorphisms from 
$(\mathbb{Z}/n \mathbb{Z})*$ to $R*$. Given a Dirichlet character $\chi : (\mathbb{Z}/n \mathbb{Z})* \to R*$, \lean{œá.lev} 
returns the level $n$. Note that the linter returns an extra unused argument warning for the latter definition. \\

Another way of thinking about the Dirichlet characters of level $n$ is to think of them as multiplicative functions on $\mathbb{Z}$ 
which are periodic with period dividing $n$. To incorporate that definition, we defined : 
\begin{lstlisting}
  noncomputable abbreviation asso_dirichlet_character {R : Type*} [monoid_with_zero R] {n : ‚Ñï} (œá : dirichlet_character R n) : zmod n ‚Üí* R :=
  { to_fun := function.extend (units.coe_hom (zmod n)) ((units.coe_hom R) ‚àò œá) 0,
    map_one' := _,
    map_mul' := _, }
\end{lstlisting}

Given a Dirichlet character $\chi$, \lean{asso\_dirichlet\_character œá} returns a monoid homomorphism from $\mathbb{Z}/n \mathbb{Z}$ 
to $R$, which is $\chi$ on the units and 0 otherwise. Most of our work is on $\mathbb{Z}/n \mathbb{Z}$ instead of its units, hence this 
is a vital definition. The following useful theorem relates the two definitions :
\begin{lstlisting}
  lemma asso_dirichlet_character_eq_char {R : Type*} [monoid_with_zero R] {n : ‚Ñï}
  (œá : dirichlet_character R n) (a : units (zmod n)) : 
  asso_dirichlet_character œá a = œá a 
\end{lstlisting}

\subsubsection{Changing levels, primitivity and multiplication}
As mentioned earlier, one would like to shift between compatible Dirichlet characters of different levels. For this, we have the following tools : 
\begin{lstlisting}
  /-- Extends the Dirichlet character œá of level n to level m, where n | m. -/
  def change_level {m : ‚Ñï} (hm : n | m) : dirichlet_character R m :=
    œá.comp (units.map (zmod.cast_hom hm (zmod n)))
  /-- œá‚ÇÄ of level d factors through œá of level n if d | n and œá‚ÇÄ = œá ‚àò (zmod n ‚Üí zmod d). -/
  structure factors_through (d : ‚Ñï) : Prop :=
  (dvd : d | n)
  (ind_char : ‚àÉ œá‚ÇÄ : dirichlet_character R d, œá = œá‚ÇÄ.change_level dvd)
\end{lstlisting}

\lean{classical.some} makes an arbitrary choice of an element from a space, if the space
is nonempty, and \lean{classical.some\_spec} lists down the properties of this random element
coming from the space. In particular, we can use \lean{classical.some (œá.factors\_through d).ind\_char} 
to extract $\chi_0$, and \lean{classical.some\_spec (œá.factors\_through d).ind\_char} to get 
\lean{œá = œá‚ÇÄ.change\_level dvd}.

With the assistance of a few lemmas, it is easy to translate between \lean{change\_level} and \lean{factors\_through}. The notion of primitivity 
and conductor of a Dirichlet character now follows easily : 
\begin{lstlisting}
  /-- The set of natural numbers for which a Dirichlet character is periodic. -/
def conductor_set : set ‚Ñï := {x : ‚Ñï | œá.factors_through x}

/-- The minimum natural number n for which a Dirichlet character is periodic.
  The Dirichlet character œá can then alternatively be reformulated on ‚Ñ§/n‚Ñ§. -/
noncomputable def conductor : ‚Ñï := Inf (conductor_set œá)

/-- A character is primitive if its level is equal to its conductor. -/
def is_primitive : Prop := œá.conductor = n

/-- The primitive character associated to a Dirichlet character. -/
noncomputable def asso_primitive_character : dirichlet_character R œá.conductor :=
  classical.some (œá.factors_through_conductor).ind_char
\end{lstlisting}

Note that our definition of Dirichlet characters holds also for $n = 0$, ie, on $\mathbb{Z}$. 
This is easily separated from the rest by the lemma : 
\begin{lstlisting}
lemma conductor_eq_zero_iff_level_eq_zero : œá.conductor = 0 ‚Üî n = 0
\end{lstlisting}

An issue with the definition \lean{is\_primitive} is that it equates the levels of of two Dirichlet characters, 
however, this does not imply the types are equal. As an example, consider natural numbers $a$ and $b$ such that 
$a = b$. Then Lean does not identify \lean{dirichlet\_character R a} and \lean{dirichlet\_character R b} as the 
same. In fact, it is best avoided to make lemmas about equality of types. One way to deal with this is to use 
the \lean{subst} tactic, which substitutes $a$ with $b$ everywhere, however, this does not work here. Also, we 
can show that they are multiplicatively equivalent (this is a bijection which preserves multiplication) : 
\begin{lstlisting}
  /-- If m = n are positive natural numbers, then their Dirichlet character spaces are equivalent. -/
def equiv {a b : ‚Ñï} (h : a = b) :
  dirichlet_character R a ‚âÉ* dirichlet_character R b
\end{lstlisting}

This is especially problematic when we must prove a theorem for a general $n$, because, for $n = 0$, Lean does 
not automatically identify \lean{zmod n} with \lean{‚Ñ§}. \\
Once we have the notion of primitivity, we can define multiplication of Dirichlet characters. Traditionally, this is 
defined only for primitive characters. We extend the definition for any two characters: 
\begin{lstlisting}
noncomputable def mul {m n : ‚Ñï} (œá‚ÇÅ : dirichlet_character R n) 
  (œá‚ÇÇ : dirichlet_character R m) :=
asso_primitive_character (change_level œá‚ÇÅ (dvd_lcm_left n m) * 
  change_level œá‚ÇÇ (dvd_lcm_right n m))
\end{lstlisting}
This takes as input characters $\chi_1$ and $\chi_2$ of levels n and $m$ respectively, and returns the primitive 
character associated to $\chi_1' \chi_2'$, where $\chi_1'$ and $\chi_2'$ are obtained by changing the levels 
of $\chi_1$ and $\chi_2$ to $n m$. 

\subsubsection{Additional properties}
Finally, one needs the notion of odd and even characters. A character $\chi$ is odd if $\chi (-1) = -1$, and 
even otherwise (in this case, $\chi (-1) = 1$). If the target is a commutative ring, then any character is 
either odd or even : 
\begin{lstlisting}
  lemma is_odd_or_is_even {S : Type*} [comm_ring S] [no_zero_divisors S] {m : ‚Ñï} 
    (œà : dirichlet_character S m) : œà.is_odd ‚à® œà.is_even
\end{lstlisting}
The proof is simple : $\psi (-1)^2 = 1$ must imply that $\psi(-1)^2 - 1^2 = (\psi(-1) - 1)(\psi(-1) + 1)$. 
This lemma, called \lean{sq\_sub\_sq} is where commutativity of the ring is needed. To conclude that one 
of the factors must be 0, we need the lemma \lean{mul\_eq\_zero}, which requires that $S$ has no zero divisors. \\
An important consequence of this is : 
\begin{lstlisting}
lemma asso_odd_dirichlet_character_eval_sub (x : zmod m) (hœà : œà.is_odd) :
  asso_dirichlet_character œà (m - x) = -(asso_dirichlet_character œà x)
lemma asso_even_dirichlet_character_eval_sub (x : zmod m) (hœà : œà.is_even) :
  asso_dirichlet_character œà (m - x) = (asso_dirichlet_character œà x)
\end{lstlisting}

Other important properties include : 
\begin{lstlisting}
/-- Dirichlet characters are continuous. -/
lemma dirichlet_character.continuous {R : Type*} [monoid R] [topological_space R]
  {n : ‚Ñï} (œá : dirichlet_character R n) : continuous œá
/-- Associated Dirichlet characters are continuous. -/
lemma dirichlet_character.asso_dirichlet_character_continuous
  {R : Type*} [monoid_with_zero R] [topological_space R] {n : ‚Ñï} 
  (œá : dirichlet_character R n) : continuous (asso_dirichlet_character œá) 
/-- Associated Dirichlet characters are bounded. -/
lemma dirichlet_character.asso_dirichlet_character_bounded {R : Type*} 
  [monoid_with_zero R] [normed_group R] {n : ‚Ñï} [fact (0 < n)] 
  (œá : dirichlet_character R n) : ‚àÉ M : ‚Ñù,
  ‚Äñ(‚ü®asso_dirichlet_character œá, œá.asso_dirichlet_character_continuous‚ü© : 
    C(zmod n, R))‚Äñ < M 
\end{lstlisting}

In the last lemma, the norm is the sup norm on $C(\mathbb{Z}/n \mathbb{Z}, R$). \\
These are all the ingredients we needed. Let us now define a special Dirichlet character, the Teichm√ºller character.

\subsubsection{Teichm√ºller character}
% Given $a \in \mathbb{Z}_p^{\times}$, there exists a unique $(p - 1)^{st}$-root of unity
% $b \in \mathbb{Z}_p$ such that $a \equiv b \text{(mod p)}$.
% This gives us the Teichm√ºller character
% $\omega : \mathbb{Z}_p^{\times} \xrightarrow[]{} \mathbb{Z}_p^{\times}$. \\
The initial effort was to formalise the definition of the Teichm√ºller character directly. 
However, it was discovered that Witt vectors, and in particular Teichm√ºller lifts had previously 
been added to \lean{mathlib}. This was used and was very helpful. It reiterates the importance 
of the collaborative spirit of Lean, and of making definitions in the correct generality. \\

It is beyond the scope of this text to define Witt vectors and do it justice. For a commutative ring
$R$ and a prime number $p$, one can obtain a ring of Witt vectors $\mathbb{W}(R)$.
When we take $R = \mathbb{Z}/p \mathbb{Z}$, we get that

\begin{lstlisting}
  def equiv : $\mathbb{W}$ (zmod p) ‚âÉ+* ‚Ñ§_[p]
\end{lstlisting}

One also obtains the Teichm√ºller lift $R \to \mathbb{W} (R)$. Given $r \in R$, 
the 0-th coefficient is $r$, and the other coefficients are 0. This map is a 
multiplicative monoid homomorphism and is denoted \lean{teichmuller}. \\

Note that given a multiplicative homomorphism \lean{R ‚Üí* S} for monoids \lean{R} 
and \lean{S}, one can obtain a multiplicative homomorphism \lean{units R ‚Üí* units S}. 
This translation is done by \lean{units.map}. Combining this with the previous two 
definitions, we obtain our definition of the Teichm√ºller character from 
$(\mathbb{Z}/p \mathbb{Z})^{\times} \to \mathbb{Z}_p$ :
\begin{lstlisting}
/-- The Teichmuller character defined on units ‚Ñ§/p‚Ñ§. -/
noncomputable abbreviation teichmuller_character_mod_p (p : ‚Ñï) 
  [fact (nat.prime p)] : dirichlet_character ‚Ñ§_[p] p :=
  units.map (((witt_vector.equiv p).to_monoid_hom).comp (witt_vector.teichmuller p))
\end{lstlisting}

Often we shall view this as taking values in a $\mathbb{Q}_p$-algebra $R$, by composing it 
with the algebra map \lean{algebra\_map ‚Ñ§\_[p] R}, which identifies elements of $\mathbb{Q}_p$ 
in $R$. \\

One of the important properties of Teichm√ºller characters is that for odd primes $p$, the character is 
primitive : 
\begin{lstlisting}
lemma is_primitive_teichmuller_character_zmod_p (p : ‚Ñï) [fact (nat.prime p)] 
  (hp : 2 < p) : (teichmuller_character_mod_p p).is_primitive
\end{lstlisting}
The proof is as follows : The conductor must divide the level $p$, hence it must be 1 or $p$. Thus it 
suffices to prove that for $2 < p$, the conductor is not 1. The result then follows from : 
\begin{lstlisting}
lemma conductor_eq_one_iff {n : ‚Ñï} (œá : dirichlet_character R n) (hn : 0 < n) : 
  œá = 1 ‚Üî œá.conductor = 1 
lemma teichmuller_character_mod_p_ne_one (p : ‚Ñï) [fact (nat.prime p)] (hp : 2 < p) :
  teichmuller_character_mod_p p ‚â† 1
\end{lstlisting}
The proof of the latter uses the fact that the Teichm√ºller character is injective (follows from 
properties of the Teichm√ºller lift), while 1 is not. For $p = 2$, we know the Teichm√ºller character is 1 : 
\begin{lstlisting}
lemma teichmuller_character_mod_p_two : teichmuller_character_mod_p 2 = 1
\end{lstlisting}

% Composing \lean{equiv} with \lean{to\_zmod\_pow 1} defined in the previous section, we obtain
% the desired homomorphism $\omega$, defined in Lean as :
% \begin{lstlisting}
% noncomputable def Teichm√ºller_character : 
%   monoid_hom (units ‚Ñ§_[p]) ‚Ñ§_[p] :=
% {  to_fun := Œª a, witt_vector.equiv p (witt_vector.Teichm√ºller_fun p (padic_int.to_zmod (a : ‚Ñ§_[p]))),
%   ..monoid_hom.comp (witt_vector.equiv p).to_monoid_hom
%   (monoid_hom.comp (witt_vector.Teichm√ºller p)
%     (monoid_hom.comp (padic_int.to_zmod).to_monoid_hom
%       ‚ü®(coe : units ‚Ñ§_[p] ‚Üí ‚Ñ§_[p]), units.coe_one, units.coe_mul‚ü©)), }
% \end{lstlisting}
% The first two lines of the definition define the function, while the rest proves that it is a
% monoid homomorphism, since it is a composition of monoid homomorphisms.

\subsection{Bernoulli polynomials and the generalized Bernoulli number}
The Bernoulli polynomials, an important number theoretic object, are a generalization of
Bernoulli numbers. They occur as special values
of $p$-adic $L$-functions. The Bernoulli numbers $B_n$ are generating functions given by :
$$\sum B_n\frac{t^n}{n!}=\frac{t}{e^{t} - 1}$$

Note that several authors think of Bernoulli numbers $B_n'$ to be defined as :
$$\sum B_n'\frac{t^n}{n!}=\frac{t}{1-e^{-t}}$$

The difference between these two is : $B_n' = (-1)^n B_n$, with $B_1 = - \frac{1}{2}$.
On using the Taylor series expansion for $e^t$ and equating coefficients, one gets,
$$ B_n = 1 - \sum_{k = 0}^{n - 1} {n \choose k} \frac{B_k}{n - k + 1} $$

In \lean{mathlib}, $B_n$ was already defined (by Johan Commelin) as :
\begin{lstlisting}
  bernoulli' n = 1 - ‚àë k : fin n, n.choose k / (n - k + 1) * bernoulli' k
\end{lstlisting}
However, we needed $B_n'$, which was then defined as :
\begin{lstlisting}
  def bernoulli (n : ‚Ñï) : ‚Ñö := (-1)^n * bernoulli' n
\end{lstlisting}

The Bernoulli polynomials, denoted $B_n(X)$, a generalization of the Bernoulli numbers,
are generating functions :
$$ \sum_{n = 0}^{\infty} B_n(X) \frac{t^n}{n!} = \frac{t e^{tX}}{e^t - 1} $$

A calculation similar to the one above gives :
$$ B_n (X) = \sum_{i = 0}^n {n \choose i} B_i X^{n - i} $$

We now define the Bernoulli polynomials as :
\begin{lstlisting}
  def polynomial.bernoulli (n : ‚Ñï) : polynomial ‚Ñö :=
  ‚àë i in range (n + 1), polynomial.monomial (n - i) ((bernoulli i) * (choose n i))
\end{lstlisting}

Here, \lean{polynomial.monomial n a} translates to $a X^n$. A small aspect of this 
naming convention is that if the namespaces for Bernoulli numbers and polynomials are both open 
(which is often the case), in order to use the Bernoulli numbers, one needs to use \lean{\_root\_.bernoulli}. 
We shall use them interchangeably here, when the context is clear. \\

\subsubsection{Properties}
The following properties of Bernoulli polynomials were proved :
\begin{enumerate}
  \item $ B_0(X) = 1 $ : \begin{lstlisting}
    lemma polynomial.bernoulli_zero : bernoulli 0 = 1
  \end{lstlisting}
  For a polynomial $f$ over a ring $R$, \lean{f.eval x} translates to $f(x)$.
  \item $ B_n(0) = B_n $ : \begin{lstlisting}
    lemma polynomial.bernoulli_eval_zero (n : ‚Ñï) : 
    (bernoulli n).eval 0 = bernoulli n
  \end{lstlisting}
  \item $ B_n(1) = B_n' $ : \begin{lstlisting}
    lemma polynomial.bernoulli_eval_one (n : ‚Ñï) : 
    (bernoulli n).eval 1 = bernoulli' n
  \end{lstlisting}
  The theorem \lean{power\_series.mk} (abbreviated as \lean{mk}) defines a formal power series in terms of its
  coefficients, that is, $\sum_{n = 0}^{\infty} a_n X^n$ translates to \lean{mk (Œª n, a\_n)}.
  \item For a commutative $\mathbb{Q}$-algebra $A$ and $t \in A$, 
  $$ \bigg( \sum_{n = 0}^{\infty} B_n(t) \frac{X^n}{n!} \bigg) (e^X - 1) = X e^{tX} : $$
  \begin{lstlisting}
  theorem polynomial.bernoulli_generating_function (t : A) :
  mk (Œª n, aeval t ((1 / n! : ‚Ñö) ‚Ä¢ bernoulli n)) * (exp A - 1) = 
    X * rescale t (exp A)
  \end{lstlisting}
\end{enumerate} 
The symbol \lean{$\cdot$} represents scalar multiplication of $\mathbb{Q}$ on $\mathbb{Q}$-polynomials. 
The exponential function $e^{x}$, which is defined as a Taylor series expansion,
takes as input $A$, but not $x$. In order to define $e^{tx}$, we need to use
(the ring homomorphism) \lean{rescale y}, which, for an element $y$ of a commutative semiring $B$,
takes a formal power series over $B$, say $f(X)$, to $f(yX)$. \\

The proof of the last theorem involves equating the $n^{th}$ coefficients of the RHS and the LHS.
After differentiating between n zero and nonzero, one requires the following lemma to complete the
nonzero case :
\begin{lstlisting}
  theorem polynomial.sum_bernoulli (n : ‚Ñï) :
  ‚àë k in range (n + 1), ((n + 1).choose k : ‚Ñö) ‚Ä¢ bernoulli k =
    polynomial.monomial n (n + 1 : ‚Ñö)
\end{lstlisting}

The proof of this theorem follows from the following property of Bernoulli numbers :

\begin{lstlisting}
  theorem sum_bernoulli (n : ‚Ñï):
  ‚àë k in range n, (n.choose k : ‚Ñö) * bernoulli k = if n = 1 then 1 else 0
\end{lstlisting}

This follows from the analogous theorem \lean{sum\_bernoulli'}, whose proof follows from rearranging
sums and the definition of \lean{bernoulli'}. \\

In order to prove properties of generalized Bernoulli numbers, we needed the following theorem :
\begin{lstlisting}
/-- Bernoulli polynomials multiplication theorem :
For k ‚â• 1, B_m(k*x) = ‚àë i in range k, B_m (x + i / k).  -/
theorem bernoulli_eval_mul' (m : ‚Ñï) {k : ‚Ñï} (hk : k ‚â† 0) (x : ‚Ñö) :
  (bernoulli m).eval ((k : ‚Ñö) * x) = 
  k^(m - 1 : ‚Ñ§) * ‚àë i in range k, (bernoulli m).eval (x + i / k) 
\end{lstlisting}

There were several different approaches to the proof. Induction on any of the 3 variables did not work 
out either. We did end up with a proof using Faulhaber's theorem (the proof has been formalised in Lean) 
for \lean{x:‚Ñï}, which could not be easily generalized to \lean{x:‚Ñö}. Finally, we used the generating function 
equality, which makes the proof calculation heavy. That is, it suffices to show that 
$$ \sum_n \sum_{i = 0}^{k - 1} \frac{k^{n - 1}}{n!} B_n \bigg(x + \frac{i}{k} \bigg) = (e^{kx} - 1) \sum_n \frac{B_n (kx)}{n!} $$

We can now define the generalized Bernoulli numbers, the special values $p$-adic $L$-functions take at negative integers.

\subsubsection{Generalized Bernoulli numbers}
Given a primitive Dirichlet character $\chi$ of conductor $f$, let us now define the generalized
Bernoulli numbers (section 4.1, \cite{cyc}) :
$$ \sum_{n = 0}^{\infty} B_{n,\chi} \frac{t^n}{n!} = \sum_{a = 1}^f \frac{\chi(a)t e^{at}}{e^{ft} - 1} $$

For any multiple $F$ of $f$, Proposition 4.1 of \cite{cyc} gives us : 
$$ B_{n, \chi} = F^{n - 1} \sum_{a = 1}^{F} \chi (a) B_n \bigg( \frac{a}{F} \bigg) $$

This is much easier to work with, modulo a dependency on the argument $F$. Taking $F = f$, we chose to formalise this 
to be our definition in Lean :
\begin{lstlisting}
def general_bernoulli_number {S : Type*} [comm_semiring S] [algebra ‚Ñö S] {n : ‚Ñï} 
  (œà : dirichlet_character S n) (m : ‚Ñï) : S :=
  (algebra_map ‚Ñö S ((œà.conductor)^(m - 1 : ‚Ñ§)))*(‚àë a in finset.range œà.conductor,
  asso_dirichlet_character (asso_primitive_character œà) a.succ * 
  algebra_map ‚Ñö S ((polynomial.bernoulli m).eval (a.succ / œà.conductor : ‚Ñö)))
\end{lstlisting}

This definition is for all characters, contrary to the typical definition, which is only for primitive characters. 
Note that the sum ranges from 0 to $f$. This does not make a difference since the 
values of the summand at 0 and $f$ are the same (zero). Also note that the Dirichlet 
character $\psi$ takes values in a general commutative semiring (explain semiring) 
which is a $\mathbb{Q}$-algebra, and (the ring homomorphism) \lean{algebra\_map ‚Ñö S} 
identifies elements of $\mathbb{Q}$ in $S$. One had to also explicitly mention that 
\lean{m - 1} must be taken to have type \lean{‚Ñ§}, since Lean would otherwise infer 
it to have type \lean{‚Ñï}, which might have caused errors (subtraction on $\mathbb{N}$ 
and $\mathbb{Z}$ are different). Automatically, the power changes from \lean{nat.pow} to 
\lean{zpow}. Finally, note that the primitive Dirichlet character associated to $\psi$ was 
chosen; we would have obtained incorrect values if we chose \lean{œà.asso\_dirichlet\_character} instead. \\ 

The following are some important properties of generalized Bernoulli numbers : 
\begin{lstlisting}
/-- B_{n,1} = B_n, where 1 is the trivial Dirichlet character of level 1. -/
lemma general_bernoulli_number_one_eval {n : ‚Ñï} :
  general_bernoulli_number (1 : dirichlet_character S 1) n = 
  algebra_map ‚Ñö S (bernoulli' n) 
/-- Showing that the definition of general_bernoulli_number is independent of F,
  where F is a multiple of the conductor. -/
lemma eq_sum_bernoulli_of_conductor_dvd {F : ‚Ñï} [hF : fact (0 < F)] (m : ‚Ñï) 
  (h : œà.conductor | F) : general_bernoulli_number œà m = 
  (algebra_map ‚Ñö S) (F^(m - 1 : ‚Ñ§)) * (‚àë a in finset.range F, 
  asso_dirichlet_character œà.asso_primitive_character a.succ *
  algebra_map ‚Ñö S ((polynomial.bernoulli m).eval (a.succ / F : ‚Ñö))) 
\end{lstlisting}

The latter lemma proves Proposition 4.1 of \cite{cyc}. An important ingredient of the proof is : 
\begin{lstlisting}
/-- `‚àë_{a = 0}^{m*n - 1} f a = ‚àë_{i = 0}^{n - 1} (‚àë_{a = m*i}^{m*(i + 1)} fa)`. -/
lemma finset.sum_range_mul_eq_sum_Ico {m n : ‚Ñï} (f : ‚Ñï ‚Üí S) :
  ‚àë a in finset.range (m * n), f a =
  ‚àë i in finset.range n, (‚àë a in finset.Ico (m * i) (m * i.succ), f a) 
\end{lstlisting}

The proof is as follows : since $F$ is a multiple of $f$, we use the above lemma to unfold the RHS, 
and \lean{eval\_bernoulli\_mul'} (discussed in the previous section) to expand the LHS. The hypothesis 
that $F > 0$ is needed so we can cancel the $f^{m - 1}$ terms from both sides. Moreover, this theorem is 
false for $F = 0$, since there is no dependency of the LHS on $F$. \\

An important property of these numbers is (from Proposition 7.2 of \cite{cyc}) : 
$$ \lim_{n \to \infty} \frac{1}{dp^{n}} \sum_{0 < a < dp^{n} ; (a, dp) = 1} \chi \omega^{-m} (a) a^{m} = 
  (1 - \chi \omega^{-m} (p) p^{m-1}) B_{m, \chi \omega^{-m}} $$

This is used heavily in the proof of the special values of the $p$-adic $L$-functions theorem (cite). 
We shall discuss its proof in Section 4 (link).

\subsection{Filters and convergence}
None of the mathematical proofs require filters on paper, however, we find that working with them makes 
formalising these proofs significantly less cumbersome. We shall not delve into the details of what a 
filter is, but instead explain how we use them to formalise convergence and limits. \\

Often, we have expressions of the form $\lim_{n \to \infty} f_n(x) = a$ for a sequence of functions $(f_n)_n$. 
This is represented in Lean as :
\begin{lstlisting}
  filter.tendsto (Œª n : ‚Ñï, f_n) filter.at_top (nhds a)
\end{lstlisting}
Here, \lean{filter.at\_top} (for the naturals) is the filter on $\mathbb{N}$ generated by the collection of up-sets $\{ b | a \leq b \}$ 
for all $a \in \mathbb{N}$. There is a large library of lemmas regarding \lean{filter.tendsto} in \lean{mathlib}. 
Some important properties that we use frequently include :
\begin{lstlisting}
  lemma filter.tendsto.const_mul {M : Type} {Œ± : Type u_1} {Œ≤ : Type} 
  [topological_space Œ±] [has_mul M Œ±] [has_continuous_const_mul M Œ±] 
  {f : Œ≤ ‚Üí Œ±} {l : filter Œ≤} {a : Œ±} (hf : tendsto f l (nhds a)) (c : M) :
  tendsto (Œª x, c * f x) l (nhds (c * a))
  lemma filter.tendsto.add {Œ± : Type} {M : Type u_1} [topological_space M] 
  [has_add M] [has_continuous_add M] {f g : Œ± ‚Üí M} {x : filter Œ±} {a b : M}, 
  (hf : tendsto f x (nhds a)) (hg : tendsto g x (nhds b)) : 
  tendsto (Œª (x : Œ±), f x + g x) x (nhds (a + b))
  lemma filter.tendsto_congr {Œ± : Type} {Œ≤ : Type u_1} {f‚ÇÅ f‚ÇÇ : Œ± ‚Üí Œ≤} 
  {l‚ÇÅ : filter Œ±} {l‚ÇÇ : filter Œ≤} (h : ‚àÄ (x : Œ±), f‚ÇÅ x = f‚ÇÇ x) : 
  tendsto f‚ÇÅ l‚ÇÅ l‚ÇÇ ‚Üî tendsto f‚ÇÇ l‚ÇÅ l‚ÇÇ
  lemma tendsto_zero_of_tendsto_const_smul_zero [algebra ‚Ñö_[p] R] {f : ‚Ñï ‚Üí R} 
  {l : filter ‚Ñï} {c : ‚Ñö_[p]} (hc : c ‚â† 0) (hf : tendsto (Œª y, c ‚Ä¢ f y) l (nhds 0)):
  tendsto (Œª x, f x) l (nhds 0) 
  lemma filter.tendsto_congr' {Œ± : Type} {Œ≤ : Type u_1} {f‚ÇÅ f‚ÇÇ : Œ± ‚Üí Œ≤} 
  {l‚ÇÅ : filter Œ±} {l‚ÇÇ : filter Œ≤} (h : f‚ÇÅ =·∂†[l‚ÇÅ] f‚ÇÇ) : 
  tendsto f‚ÇÅ l‚ÇÅ l‚ÇÇ ‚Üî tendsto f‚ÇÇ l‚ÇÅ l‚ÇÇ
\end{lstlisting}

The last lemma is particularly useful. it shows that sequences that are eventually equal (the same after finitely many 
elements) have the same limit. In particular, given \lean{f‚ÇÅ f‚ÇÇ : ‚Ñï ‚Üí R}, \lean{f‚ÇÅ =·∂†[at\_top] f‚ÇÇ} is equivalent to saying that 
\lean{‚àÉ (a : ‚Ñï), ‚àÄ (b : ‚Ñï), b ‚â• a, f‚ÇÅ b = f‚ÇÇ b}. \\

We aim to use these lemmas as much as possible in order to avoid messy calculations with inequalities on norms. The only places they are 
not used are when it is necessary to deal with the inequalities, specifically when the non-Archimedean condition on the ring needs to be used.

\section{Construction of the $p$-adic $L$-function}
\subsection{Profinite spaces}
\subsubsection{Density of locally constant functions}
In Proposition 12.1 of \cite{cyc}, Washington defines the $p$-adic integral on $C(X, \mathbb{C}_p)$,
the Banach space of continuous functions from a profinite space X to $\mathbb{C}_p$.
This is an extension of a function defined on a dense subset of $C(X, \mathbb{C}_p)$, the
locally constant functions from X to $\mathbb{C}_p$. In fact, for any compact
Hausdorff totally disconnected space X and a commutative
normed ring A, $LC(X, A)$ is a dense subset of $C(X, A)$. \\

The mathematical proof is the following : For $f \in C(X, A)$, we want to prove that,
for any $\epsilon > 0$, we have $R = \bigcup_{x \in R} B(x, \epsilon)$. Since X is compact,
one can find finitely many open sets $U_1, \dots, U_n$ such that $U_i = f^{-1}(B(x_i, \epsilon))$
for $x_1, \dots, x_n$ in R. One needs the fact that compact Hausdorff totally disconnected spaces
have a clopen basis. We then find a finite set of disjoint clopen sets $C_1, \dots, C_m$ which form
a basis, such that each $C_j$ is contained in some $U_i$.
Then, we pick elements $a_1, \dots, a_m$ in $C_1, \dots, C_m$, and construct the locally constant
function $g(x) := \sum_{j = 1}^m f(a_j) \chi_{C_j}(x)$, where $\chi_U$ is the characteristic
(locally constant) function taking value 1 on every element of U and 0 otherwise. It then follows
that $|| f - g || = sup_{x \in X} ||f(x) - g(x)|| < \epsilon$, as required. \\

formalising this took about 500 lines of code. Let us show that locally compact Hausdorff
totally disconnected spaces have a clopen basis :

\begin{lstlisting}
lemma loc_compact_Haus_tot_disc_of_zero_dim {H : Type*} [topological_space H] 
[locally_compact_space H] [t2_space H] [totally_disconnected_space H] :
  is_topological_basis {s : set H | is_clopen s}
\end{lstlisting}

The mathematical proof is : We want to show that for every $x \in H$ and open set $U$ such that
$x \in U$, there exists a clopen set $C$ such that $x \in C$ and $C \subseteq U$. Since $H$ is a
locally compact space, we can find a compact set $s$ such that $x \in \text{(interior s)}$ and
$s \subseteq U$. The following lemma states that, every member of an open set in a compact Hausdorff 
totally disconnected space is contained in a clopen set contained in the open set. :
\begin{lstlisting}
lemma compact_exists_clopen_in_open {x : Œ±} {U : set Œ±} (is_open : is_open U) 
  (memU : x ‚àà U) : ‚àÉ (V : set Œ±) (hV : is_clopen V), x ‚àà V ‚àß V ‚äÜ U
\end{lstlisting}
This implies that we can find a clopen set $V \subseteq \text{(interior s)}$ of $s$, with $x \in V$. 
Since $V$ is closed in $s$(compact, hence closed), $V$ is closed in $H$. Since
$V \subseteq \text{(interior s)}$ is open in $s$, hence in (interior $s$), $V$ is open in $H$, thus
we are done. \\

This turned out to be harder to formalise than expected. Lean gives a subset $V$ of s \newline (\lean{compact\_space s ‚Üî is\_compact (s:set H)}) 
the type \lean{V:set s}; however, Lean does not recognize $V$ as a subset of $H$. As a result, I must construct \lean{V':set H} 
to be the image of $V$ under the closed embedding \lean{coe:s ‚Üí H}. This process must be repeated each time a subset of $H$, 
which is also a topological subspace, is considered. Finally, it must be shown that all these coercions match up in the big 
topological space $H$.

%%and $s$ has type \lean{set H}, but does not recognize $V$ as a subset of  This is because $s$, which is of type
%%\lean{s : set H} also has the property \lean{is\_compact (s:set H)}. This is equivalent to saying
%%that $s$ is a compact space, that is, \lean{compact\_space (set.univ:set s)}, where
%%\lean{(set.univ:set s)} is simply $s$ viewed as a set of itself, instead of a topological space.
%%Now, if we have $V$ to be a subset of $s$ of type \lean{V:set s}, Lean does not recognize it as
%%a subset of $H$. We construct \lean{V':set H} to be the image of $V$ under the closed embedding \lean{coe:s ‚Üí H}. This process must be repeated each time we consider a
%%subset as a topological space.

\subsubsection{Clopen sets of the $p$-adic integers}
As mentioned before, $\mathbb{Z}_p$ is a profinite space. Since it is the inverse limit of finite
discrete topological spaces $\mathbb{Z}/p^n \mathbb{Z}$ for all $n$, it has a clopen basis of the
form $U_{a,n} := proj_n ^{-1} (a)$ for $a \in \mathbb{Z}/p^n \mathbb{Z}$, where $proj_n$ is the
canonical projection ring homomorphism \lean{to\_zmod\_pow n:$\mathbb{Z}$\_[p] ‚Üí+* zmod (p $\hat{}$ n)}. \\

We first define the collection of sets $(U_{a,n})_{a,n}$ :
\begin{lstlisting}
  def clopen_basis : set (set ‚Ñ§_[p]) := 
  {x : set ‚Ñ§_[p] | ‚àÉ (n : ‚Ñï) (a : zmod (p^n)),
  x = set.preimage (padic_int.to_zmod_pow n) {a} }
\end{lstlisting}

We now want to show that \lean{clopen\_basis} forms a topological basis and that every element is
clopen :
\begin{lstlisting}
  theorem clopen_basis_clopen : 
    topological_space.is_topological_basis (clopen_basis p) ‚àß
    ‚àÄ x ‚àà (clopen_basis p), is_clopen x
\end{lstlisting}
The mathematical proof is to show that for any $\epsilon$-ball, one can find $U_{a,n}$ inside it.
This is true because, given $n \in \mathbb{N}$ and $x \in \mathbb{Z} / p^n \mathbb{Z}$, the preimage of $x$ 
under \lean{to\_zmod\_pow n} is the same as the ball centered at $x$ (now considered as an element of $\mathbb{Z}_p$) with radius $p^{1 - n}$ :
\begin{lstlisting}
  lemma preimage_to_zmod_pow_eq_ball (n : ‚Ñï) (x : zmod (p^n)) : 
  (to_zmod_pow n) ‚Åª¬π' {(x : zmod (p^n))} = 
    metric.ball (x : ‚Ñ§_[p]) ((p : ‚Ñù) ^ (1 - (n : ‚Ñ§)))
\end{lstlisting}

Notice that, in the RHS, we must specify \lean{n:‚Ñ§}. If that is not done, Lean interprets \lean{1 - n:‚Ñï}. This is not the same as 
\lean{1 - n:‚Ñ§}, since subtraction is defined differently for the naturals. \\
Proving this lemma was fairly straightforward using the expansion of a $p$-adic integer, that is, every
$a \in \mathbb{Z}_p$ can be written as $\sum_{n = 0}^{\infty} a_n p^n$, with $a_n \in \mathbb{Z}/p^n \mathbb{Z}$.
Approximating $a$ by $\sum_{n = 0}^{m} a_n p^n$ is done by the function \lean{appr:$\mathbb{Z}$\_p ‚Üí $\mathbb{N}$ ‚Üí $\mathbb{N}$}.
Note that \lean{appr} returns a natural number, with $a_n$ being the smallest natural number in the
$\mathbb{Z}/p^n \mathbb{Z}$ equivalence class. This turned out to be very useful, along with the
following lemmas :

\begin{lstlisting}
  lemma appr_spec (n : ‚Ñï) (x : ‚Ñ§_[p]) :  
    x - appr x n ‚àà (ideal.span {p^n} : ideal ‚Ñ§_[p])
  lemma has_coe_t_eq_coe (x : ‚Ñ§_[p]) (n : ‚Ñï) :
  (((appr x n) : zmod (p^n)) : ‚Ñ§_[p]) = ((appr x n) : ‚Ñ§_[p])
\end{lstlisting}

In the latter lemma, the LHS is a coercion of \lean{appr x n}, which has type \lean{$\mathbb{N}$}, to \lean{$\mathbb{Z}$\_p}. 
The RHS is a coercion of \lean{appr x n} to \lean{zmod (p $\hat{}$ n)} to \lean{$\mathbb{Z}$\_p}. 
This statement is not true in general, that is, given any natural number $n$, it is not true that the lift of $n$ to $\mathbb{Z}_p$ 
is the same as the composition of its lift to $\mathbb{Z}/p^n \mathbb{Z}$ and $\mathbb{Z}_p$. 
It works here because the coercion from $\mathbb{Z}/p^n \mathbb{Z}$ to $\mathbb{Z}_p$ is not the canonical lift.
It is a composition of a coercion from $\mathbb{Z}/p^n \mathbb{Z}$ to $\mathbb{N}$, which takes
$a \in \mathbb{Z}/p^n \mathbb{Z}$ to the smallest natural number in its
$\mathbb{Z}/p^n \mathbb{Z}$ equivalence class. \\

One can similarly show that the sets $U_{b, a, n} := proj_1^{-1} (b) \times proj_{2,n} ^{-1} (a)$ form a clopen basis for 
$\mathbb{Z} / d \mathbb{Z} \times \mathbb{Z}_p$, where $proj_1$ is the first canonical projection on $b \in \mathbb{Z} / d \mathbb{Z}$ 
and $proj_{2,n}$ the composition of the second projection on $a \in \mathbb{Z}_p$ with $proj_n$ descried above. We call this set 
\lean{clopen\_basis' p d}. For the sake of simplicity, we shall discuss the case $d = 1$ in this article.

\subsection{$p$-adic distributions and measures}
In this section, $X = \varprojlim_{i \in \mathbb{N}} X_i$ denotes a profinite space with $X_i$ finite and
projection maps $\pi_i : X \xrightarrow[]{} X_i$ and surjective maps
$\pi_{ij} : X_i \xrightarrow[]{} X_j$ for all $i \ge j$. We use $G$ to denote an abelian group,
$A$ for a commutative normed ring, $R$ for a commutative complete normed ring having a coercion from $\mathbb{Z}_p$, 
and $LC(X,Y)$ for the space of locally constant functions from $X$ to $Y$. 
We fix a prime $p$ and an integer $d$ such that $gcd(d, p) =1$. \\

We begin by defining distributions on profinite sets. In Section 12.1 of \cite{cyc}, Washington
gives 3 equivalent definitions of a distribution :
\begin{enumerate}
  \item A system of maps $\phi_i : X_i \xrightarrow[]{} G$ such that $\forall i \ge j$,
  $$ \phi_j(x) = \sum_{\pi_{ij}(y) = x} \phi_i(y) $$
  \item A $G$-linear function $\phi : LC(X, G) \xrightarrow[]{} G$.
  \item A finitely additive function from the compact open sets of $X$ to $G$.
\end{enumerate}

Since switching between definitions is cumbersome, and(at that point of time), \lean{mathlib}
had no notion of thinking about profinite sets as inverse limits of finite sets, we chose to work
with the second definition. However, this is already a Type, hence there is no need to redefine it.

The topology on $C(X, A)$ comes from its normed group structure induced by the norm on $A$ :
$|| f - g || = sup_{x \in X} || f(x) - g(x) ||$. In fact, this topology is the same as the 
topology defined on bounded functions on $X$, since $X$ is a compact space. Since the API for bounded 
continuous functions on compact spaces was developed at around the same time (created by Oliver Nash), 
we simply used the existing lemmas along with the equivalence 
\lean{bounded\_continuous\_function.equiv\_bounded\_of\_compact}. \\

While showing that, $\forall f \in C(X, A)$, $||f|| = 0 \implies f = 0$, it suffices to show 
$||f|| \le 0 \implies \forall x \in X, ||f(x)|| \le 0$. We then use the following lemma, which 
requires a nonempty assumption on $X$ :
\begin{lstlisting}
  theorem cSup_le_iff {Œ± : Type*} [conditionally_complete_lattice Œ±] 
  {s : set Œ±} {a : Œ±} (hb : bdd_above s) (ne : nonempty s) : 
  Sup s ‚â§ a ‚Üî (‚àÄb ‚àà s, b ‚â§ a)
\end{lstlisting}

The case that $X$ is empty is separately (and trivially) solved. \\

% Ideally, there is no need to define \lean{distribution'}, since there are no additional
% properties it satisfies which linear maps do not. A database needs to be built for every definition
% made, which can be costly. Hence, in the final version, this definition will probably be
% removed. \\
We can now define $p$-adic measures. Measures are bounded distributions. Note that the $p$-adic measures
are not to be confused with measures arising from measure theory. The key difference lies in the
fact that the clopen sets of a profinite space do not, in general, form a $\sigma$-algebra. \\

\begin{lstlisting}
  def measures [nonempty X] :=
  {œÜ : (locally_constant X A) ‚Üí‚Çó[A] A // ‚àÉ K : ‚Ñù, 0 < K ‚àß 
  ‚àÄ f : (locally_constant X A), $\lVert$œÜ f$\rVert$ ‚â§ K * $\lVert$inclusion X A f$\rVert$ }
\end{lstlisting}

The boundedness of the distribution is needed to make the measure continuous :
\begin{lstlisting}
  lemma integral_cont (œÜ : measures X A) : continuous ‚áëœÜ
\end{lstlisting}

The proof is straightforward : for $b \in LC(X, A)$, given $\epsilon > 0$, there exists a
$\delta > 0$ such that for all $a \in LC(X, A)$ with $|| b - a || < \delta$,
$|| \phi(a) - \phi(b) || < \epsilon$. Since $\phi$ is a measure, it suffices to prove that
$ K * ||inclusion (a - b)|| < \epsilon $. Choosing $\delta  = \epsilon / K$ gives the desired
result. \\

The Bernoulli measure is an essential $p$-adic measure. We make a choice of an integer $c$ with
$gcd(c,dp) = 1$, and $c^{-1}$ is an integer such that $c c^{-1} \equiv 1 \text{ mod } dp^{2n+1}$.
For $x_n \in (\mathbb{Z} / dp^{n +1} \mathbb{Z})^{\times}$, the (first) Bernoulli measure is defined by
$$ E_{c,n}(x_n) = B_1 \bigg( \bigg\{ \frac{x_n}{dp^{n + 1}} \bigg\} \bigg) -
  cB_1 \bigg( \bigg\{ \frac{c^{-1}x_n}{dp^{n + 1}} \bigg\} \bigg) $$

The system $(E_{c,n})_{n \in \mathbb{N}}$ forms a distribution according to the first definition
given above. We want to get an equivalent reformulation in terms of the second definition.
We know that, since $X$ is compact, every locally constant function can be written in terms of a
finite sum of a characteristic function of a basis element multiplied by a constant. Since $X$ is
profinite, from the previous section, we know that there exists a clopen basis of the form
\lean{set.preimage (padic\_int.to\_zmod\_pow n) {a}} for $a \in\mathbb{Z}/dp^{n} \mathbb{Z}$. 
For the sake of simplicity, let us assume $d = 1$. Thus, for a
clopen set $U_{a,n} := $ \lean{set.preimage (padic\_int.to\_zmod\_pow n) {a}}, we define
$$ E_c (\chi_{U_{a,n}}) = E_{c,n} (a) $$
In Lean, this translates to (note that \lean{fract x} represents the fractional part of $x$) :
\begin{lstlisting}
def E_c (hc : gcd d p = 1) := 
  Œª (n : ‚Ñï) (a : (zmod (d * (p^n)))), fract ((a : ‚Ñ§) / (d*p^(n + 1))) 
  - c * fract ((a : ‚Ñ§) / (c * (d*p^(n + 1)))) + (c - 1)/2
\end{lstlisting}

% The tactic \lean{classical.some} makes an arbitrary choice of an element from a space, if the space
% is nonempty, and \lean{classical.some\_spec} lists down the properties of this random element
% coming from the space. In particular, given \lean{U:clopen\_basis p}, we obtain an $n$ and $a$ 
% such that $U = U_{a,n}$. \lean{bernoulli\_measure} is then defined to be the set of $R$-linear maps 
% from \lean{locally\_constant $\mathbb{Z}$\_p R} to \lean{R} which, when evaluated at any clopen basis set 
% gives the same value as $E_c$ on the set. 
%Also, it is only at this point that
%%we need to think of $\mathbb{Z}_p$ as a compact, Hausdorff,
%%totally disconnected space. \\

\subsection{The Bernoulli measure}
Throughout this section, we assume that $R$ is a normed commutative ring which is a $\mathbb{Q}_p$-algebra, 
$\mathbb{Q}$-algebra, and has a nonarchimedean norm, that is, for any finite set of elements 
$(r_i)_{i = 1}^n$ of $R$, $\sum_{i = 1}^n \parallel r_i \parallel \le \sup \parallel r_i \parallel$.

The original plan was to define a set of the form : 
\begin{lstlisting}
def bernoulli_measure (hc : c.gcd p = 1) :=
 {x : locally_constant (zmod d √ó ‚Ñ§_[p]) R ‚Üí‚Çó[R] R | ‚àÄ (n : ‚Ñï) 
    (a : zmod (d * (p^n))), x (char_fn R (is_clopen_clopen_from p d n a)) = 
    (algebra_map ‚Ñö R) (E_c p d hc n a) }
\end{lstlisting}

and to show that it is nonempty. However, this is quite a roundabout way, since one then has to use 
\lean{classical.some} to extract the Bernoulli measure. We use an elegant way to tackle the problem. \\

First, we define \lean{eventually\_constant\_seq} to be the type of sequences satifying : 
\begin{lstlisting}
/-- A sequence has the `is_eventually_constant` predicate if all the elements of the sequence are eventually the same. -/
def is_eventually_constant {Œ± : Type*} (a : ‚Ñï ‚Üí Œ±) : Prop :=
 { n | ‚àÄ m, n ‚â§ m ‚Üí a (nat.succ m) = a m }.nonempty
\end{lstlisting}

Then, given a locally constant function $f$ from $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$ to $R$, 
we define the eventually constant sequence \lean{g} to be : 
$$ g(n) = \sum_{a \in \mathbb{Z}/(d*p^n) \mathbb{Z}} f(a) E_{c, n}(a) $$ 
for all natural numbers $n$. We shall look into the proof of $g$ being eventually constant later. We now define the Bernoulli 
distribution to be the limit of this sequence $g$. \\

The proof of this distribution being closed under addition and scalar multiplication follows easily from these definitions and lemmas : 
\begin{lstlisting}
/-- The smallest number `m` for the sequence `a` such that `a n = a (n + 1)` for all `n ‚â• m`. -/
noncomputable def sequence_limit_index' {Œ± : Type*} (a : @eventually_constant_seq Œ±) : ‚Ñï :=
  Inf { n | ‚àÄ m, n ‚â§ m ‚Üí a.to_seq m.succ = a.to_seq m }

/-- The limit of an `eventually_constant_seq`. -/
noncomputable def sequence_limit {Œ± : Type*} (a : @eventually_constant_seq Œ±) :=
  a.to_seq (sequence_limit_index' a)

lemma sequence_limit_eq {Œ± : Type*} (a : @eventually_constant_seq Œ±) (m : ‚Ñï)
  (hm : sequence_limit_index' a ‚â§ m) : sequence_limit a = a.to_seq m
\end{lstlisting}

Now, given a locally constant function \lean{f : locally\_constant (units (zmod d) √ó units ‚Ñ§\_[p]) R}, 
the \lean{bernoulli\_measure} is given by : 
\begin{lstlisting}
  bernoulli_distribution p d R (loc_const_ind_fn _ p d f)
\end{lstlisting}
where \lean{loc\_const\_ind\_fn} is a locally constant function on $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$ 
that takes value $f$ on the units of the domain, and 0 otherwise. We shall skip the proof that this function is 
locally constant, because it is long and cumbersome. For every open set $s$, one must look at the case when 0 is 
contained in $s$ separately. We (prove and) use the fact that \lean{coe : units (zmod d) √ó units ‚Ñ§\_[p] ‚Üí (zmod d) √ó ‚Ñ§\_[p]} 
is an open embedding heavily. \\

We must now prove that \lean{bernoulli\_measure} is indeed a measure, that is, it is bounded. The bound we choose is 
$1 + \parallel c \parallel + \parallel \frac{c - 1}{2} \parallel$. The proof is as follows : let BD denote the Bernoulli 
distribution, and $\phi$ denote \lean{loc\_const\_ind\_fn}. We want to show that : 
$$ \parallel BD (\phi (f)) \parallel \le K \parallel inclusion (f) \parallel $$
where $K$ is the constant given above. We know that, one can find an $n$ such that 
$$\phi (f) = \sum_{a \in \mathbb{Z}/d \mathbb{Z} \times \mathbb{Z} /p^n \mathbb{Z}} \phi(f) (a) \dot{} \chi_{n,a}$$

Since $BD$ is a linear map, it suffices to show that 
$\parallel BD (\phi (f)(a) \chi_{n, a}) \parallel \le K \parallel inclusion f \parallel$ for some $a$ (the supremum is achieved 
since the set is finite). If $a$ is not a unit, $\phi (f) (a) = 0$; by using the linearity of $BD$, we are done. 
In the case that $a$ is a unit, it suffices to prove that $\parallel BD(\chi_{n, a}) \parallel \le K$, and 
$\parallel \phi (f) (a) \parallel \le \parallel inclusion f \parallel$. Both of these are easily verified, so we are done. \\

The implementation is similar, and is heavily dependent on the following lemma : 
\begin{lstlisting}
lemma loc_const_eq_sum_char_fn (f : locally_constant ((zmod d) √ó ‚Ñ§_[p]) R) 
  (hd : d.gcd p = 1) : ‚àÉ n : ‚Ñï, 
  f = ‚àë a in (finset.range (d * p^n)), 
    f(a) ‚Ä¢ char_fn R (is_clopen_clopen_from p d n a)
\end{lstlisting}

The machinery used in this proof is similar to the one used to prove that $g$ is eventually constant. Let us have a look at the latter first. \\

We must first take a look at discrete quotients. The discrete quotient on a topological space is given by an equivalence relation such 
that all equivalence classes are clopen : 
\begin{lstlisting}
structure (X : Type*) [topological_space X] discrete_quotient :=
 (rel : X ‚Üí X ‚Üí Prop)
 (equiv : equivalence rel)
 (clopen : ‚àÄ x, is_clopen (set_of (rel x)))
\end{lstlisting}

The last statement translates to, $\forall x \in X, \{ y | y \sim x \}$ is clopen. 
Given two discrete quotients $A$ and $B$, $A \le B$ means that $\forall x,y \in X$, 
$x \sim_{A} y \implies x \sim_{B} y$. \\

Any locally constant function induces a discrete quotient, since each of its fibers is clopen : 
\begin{lstlisting}
def discrete_quotient : discrete_quotient X :=
{ rel := Œª a b, f b = f a,
  equiv := ‚ü®by tauto, by tauto, Œª a b c h1 h2, by rw [h2, h1]‚ü©,
  clopen := Œª x, f.is_locally_constant.is_clopen_fiber _ }
\end{lstlisting}

We now define a function : 
\begin{lstlisting}
def F : ‚Ñï ‚Üí discrete_quotient (zmod d √ó ‚Ñ§_[p]) := Œª n, 
  ‚ü®Œª a b, to_zmod_pow n a.2 = to_zmod_pow n b.2 ‚àß a.1 = b.1, _, _‚ü©
\end{lstlisting}

In other words, for $a = (a_1, a_2)$ and $b = (b_1, b_2)$ in $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$, $F(n)$ represents the relation 
$$ a \sim b \iff a_2 (\text{mod } p^n) = b_2 (\text{mod } p^n) \and a_1 = b_1 $$
Then, given a locally constant function $f$ on $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$, we have :
\begin{lstlisting}
lemma factor_F (hd : d.gcd p = 1) (f : locally_constant (zmod d √ó ‚Ñ§_[p]) R) :
  ‚àÉ N : ‚Ñï, F N ‚â§ discrete_quotient f
\end{lstlisting}

\lean{factor\_F} states that, for $N$ large enough, the fibers of $f$ mod $p^N$ are contained in the basic clopen sets of $p^N$. 
Here is the proof of \lean{factor\_F} : Since $X$ is compact, there exists a finite set $t$ in $R$ such that $X \subseteq \cup_{i \in t} f^{-1} (i)$. 
Given an open set $U$ of $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$, we now define the \lean{bound\_set} of $U$ to be 
\newline $\{ n \in \mathbb{N} \mid \forall a \in U, U_{n, (\text{a : zmod }p^n)} \subseteq U \}$. The \lean{bound} of $U$ is then defined to be the infimum of the \lean{bound\_set U}. 
Let $n$ be the supremum of \lean{bound} of $f^{-1} (i)$ for all $i \in t$. This is the required \lean{N}. \\

The proofs of both $g$ being eventually constant now follows. We want to show : 
$$ \exists N, \forall m \ge N, \sum_{a \in \mathbb{Z}/d*p^{m + 1} \mathbb{Z}} f(a) E_{c,m + 1}(a) = \sum_{a \in \mathbb{Z}/d*p^{m} \mathbb{Z}} f(a) E_{c,m}(a) $$
The $N$ we choose is \lean{classical.some (factor\_F f) + 1}. We also define the following : 
\begin{lstlisting}
/-- Given `a ‚àà zmod (d * p^n)`, and `n < m`, the set of all `b ‚àà zmod (d * p^m)` such that `b = a mod (d * p^n)`. -/
def equi_class (n m : ‚Ñï) (h : n ‚â§ m) (a : zmod (d * p^n)) :=
 {b : zmod (d * p^m) | (b : zmod (d * p^n)) = a}
\end{lstlisting}
Then, we have the following lemma :
\begin{lstlisting}
lemma succ_eq_bUnion_equi_class : zmod' (d*p^(m + 1)) = (zmod' (d*p^m)).bUnion
  (Œª a : zmod (d * p ^ m), set.to_finset (equi_class m (m + 1)) a) 
\end{lstlisting}
This lemma says that any element of $\mathbb{Z}/dp^{m + 1} \mathbb{Z}$ comes from \lean{equi\_class m (m + 1) b} for some $b \in \mathbb{Z}/dp^m \mathbb{Z}$. 
Notice that we use \lean{zmod'} instead of \lean{zmod}, since that has type \lean{finset}, that is, the property of \lean{zmod} being finite is encoded in it. This 
is needed since we are working with finite sums, hence Lean demands elements of type \lean{finset} instead of \lean{set}. \\

The proof is now complete with the following lemma :
\begin{lstlisting}
lemma E_c_sum_equi_class (x : zmod (d * p^m)) :
  ‚àë (y : zmod (d * p ^ (m + 1))) in (Œª a : zmod (d * p ^ m), 
  set.to_finset ((equi_class m (m + 1)) a)) x, (E_c (m + 1) y) = E_c m x
\end{lstlisting}
which says that, for $x \in \mathbb{Z}/dp^m \mathbb{Z}$, $E_{c, m} (x) = \sum_{y}' E_{c, m + 1} (y)$,\newline where $y$ belongs to \lean{equi\_class m (m + 1) x}. \\

Finally, we turn to the proof of \lean{loc\_const\_eq\_sum\_char\_fn}. We want to show that, for any locally constant function $f$ from 
$\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$ to $R$, 
$$\exists n, f = \sum_{a \in \mathbb{Z}/dp^n \mathbb{Z}} f(a) \chi_{n, a}$$
We choose $n$ to be \lean{classical.some factor\_F f}. The proof now follows easily, since each element belongs to exactly one clopen set of level $n$. One must go 
between elements of $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$ and $\mathbb{Z}/dp^n \mathbb{Z}$. This requires use of multiple coercions, which makes the proof lengthy. \\

Notice that \lean{bernoulli\_distribution} takes locally constant functions on $\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$, 
while \newline \lean{bernoulli\_measure} takes locally constant functions on $\mathbb{Z}/d \mathbb{Z}^* \times \mathbb{Z}_p^*$. This had to be done since our clopen basis was defined on 
$\mathbb{Z}/d \mathbb{Z} \times \mathbb{Z}_p$, and while it is easy to show the same results for the units on paper, it requires a bit of work in Lean.

\subsection{$p$-adic integrals and the $p$-adic $L$-function}
\subsubsection{$p$-adic Integrals}
The last piece in the puzzle is the $p$-adic integral. We use the same notation as in the previous
section. Given a measure $\mu$, and a function $f \in LC(X, R)$,
$\int f d\mu := \mu(f)$. As in Theorem 12.1 of \cite{cyc}, this can be extended to a
continuous $R$-linear map :
$$ \int_X f d\mu : C(X, R) \xrightarrow[]{} R $$

This follows from the fact that $LC(X, R)$ is dense in $C(X, R)$; as a result, the map 
\newline $inclusion : LC(X, R) \xrightarrow[]{} C(X, R)$
is \lean{dense\_inducing}, that is, it has dense range and the topology on $LC(X, R)$ is the one
induced by \lean{inclusion} from the topology on $C(X,R)$. \\

For the linearity of the map, we use \lean{dense\_range.induction\_on$_2$}, which states that, given a map $e : \alpha \to \beta$ which has dense range, 
and a property $p$ (taking two elements as input), in order for any two elements of $\beta$ to satisfy $p$, it is sufficient to show that any two elements 
in the range of $e$ satisfy $p$; and, the set of elements satifying $p$ is closed with respect to the topology of $\beta$ :
\begin{lstlisting}
  lemma dense_range.induction_on‚ÇÇ {Œ± Œ≤ : Type*} [topological_space Œ≤] {e : Œ± ‚Üí Œ≤} 
  {p : Œ≤ ‚Üí Œ≤ ‚Üí Prop} (he : dense_range e) (hp : is_closed {q:Œ≤√óŒ≤ | p q.1 q.2}) 
  (h : ‚àÄa‚ÇÅ a‚ÇÇ, p (e a‚ÇÅ) (e a‚ÇÇ)) (b‚ÇÅ b‚ÇÇ : Œ≤) : p b‚ÇÅ b‚ÇÇ
\end{lstlisting}

In particular, for every continuous function $f$, we can take the property $p$ to be preservation of addition (and scalar multiplication respectively) under 
$\mu (f)$, and \lean{inclusion} to be the map with dense range. The first condition is satisfied due to the following lemma :
\begin{lstlisting}
  lemma is_closed_eq [t2_space Œ±] {f g : Œ≤ ‚Üí Œ±} (hf : continuous f) 
  (hg : continuous g) : is_closed {x:Œ≤ | f x = g x}
\end{lstlisting}

The second condition follows easily due to the linearity of the measure and the map \lean{inclusion}. \\

The continuity of the extension of the integral follows from the fact that every measure $\mu$ is uniformly continuous. Uniform continuity is a 
product of the boundedness of the measure : We want to show that, for any measure $\phi$, given an $\epsilon > 0$, $\exists \delta > 0$ such that 
for any $a, b \in LC(X, R)$, with $||a - b|| < \delta$, $|| \phi (a) - \phi (b) || < \epsilon$. Assuming that the constant in the definition of $\phi$ 
is $K$, it is clear that $\epsilon / K$ is the required $\delta$. This is the proof of the following lemma :
\begin{lstlisting}
  lemma uniform_continuous (œÜ : measures X A) : uniform_continuous ‚áëœÜ 
\end{lstlisting}

\subsubsection{Construction}
There are several possible definitions for the $p$-adic $L$-functions (fixing an embedding of
$\mathbb{\bar{\mathbb{Q}}}$ into $\mathbb{C}_p$), including :
\begin{enumerate}{}{}
  \item (Theorem 5.11, \cite{cyc}) The $p$-adic meromorphic function $L_p(s, \chi)$ on
  \newline $\{ s \in \mathbb{C}_p | |s| < p \}$ obtained by analytic continuation, such that
  $$ L_p (1 - n, \chi) = -(1 - \chi \omega^{-n}(p)p^{n - 1}) \frac{B_{n, \chi \omega^{-n}}}{n} $$
  for $n \ge 1$.
  \item (Proof of Theorem 5.11, \cite{cyc})
  $L_p(s, \chi) = \sum_{a = 1, p\nmid a}^F \chi(a)H_p(s, a, F)$, where $H_p (s, a, F)$ is a 
  meromorphic function satifying 
  \newline $H_p(1 - n, a, F) = - \frac{F^{n - 1}\omega^{-n}(a)}{n} B_n \big( \frac{a}{F} \big)$ for all 
  natural numbers $n$.
  \item (Theorem 12.2, \cite{cyc}) For $s \in \mathbb{Z}_p$, and Dirichlet character $\chi$ with
  conductor $d p^m$, with $gcd (d, p) = 1$ and $m \ge 0$, for a choice of $c \in \mathbb{Z}$
  with $gcd (c, dp) = 1$ :
  $$ (1 - \chi(c)<c>^{s+1}) L_p(-s, \chi) = \int_{(\mathbb{Z}/d \mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times}}
  \chi \omega^{-1}(a) <a>^s dE_c $$
  where $<a> = \omega^{-1}(a) a$, and $b^s = exp (log_p (b))$ (the exponential and logarithm are defined in 
  terms of power series expansions).
\end{enumerate}

It is beyond the scope of this article to explain all the notation in the points above. I chose to
define the $p$-adic $L$-function as a reformulation of (3). This is because it is the most optimal
definition that helps with stating the Iwasawa Main Conjecture. \\

Instead of using the variable $s$ (which takes values in a subset of $\mathbb{C}_p$), we choose to use an element of the weight space. We replace
$<a>^s$ with \lean{w:weight\_space A}. The advantage is that our $p$-adic $L$-function can now be defined over a more general space. \\

Given a primitive Dirichlet character $\chi$ of character $dp^m$ with $gcd(d, p) = 1$ and $m \ge 0$,
we now define the $p$-adic $L$-function to be :
$$ L_p(w, \chi) := \int_{(\mathbb{Z}/d \mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times}}
\chi \omega^{p - 2} (a) w \text{    } dE_c $$

\begin{lstlisting}
  def p_adic_L_function (hc : gcd c p = 1) :=
  integral (units (zmod d) √ó units ‚Ñ§_[p]) R _ 
  (bernoulli_measure_of_measure p d R hc)
‚ü®(Œª (a : (units (zmod d) √ó units ‚Ñ§_[p])), ((pri_dir_char_extend p d R) a) *
  (inj (Teichm√ºller_character p a.snd))^(p - 2) * (w.to_fun a : R)), 
    cont_paLf p d R inj w ‚ü©
\end{lstlisting}

Note that we have absorbed the constant term given in (3). This was done because Theorem 12.2 lets $L_p(-s, \chi)$ take values in $\mathbb{C}_p$. 
In a general ring $R$, as we have chosen, division need not exist. One would then need the factor to be a unit, which may not always happen 
(for example, consider $R = \mathbb{Q}_p$). Thus, our $p$-adic $L$-function differs from the original by a constant factor. 
However, this factor appears as it is in the Iwasawa Main Conjecture, and can be easily removed if one assumes $R$ to have division. \\

Lean (implicitly) interprets the placeholder \lean{\_} as a proof that 
\newline $(\mathbb{Z}/d \mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times} = $ \lean{units (zmod d) √ó units $\mathbb{Z}$\_[p]} is nonempty. 
Note that \lean{pri\_dir\_char\_extend} extends $\chi$
from $(\mathbb{Z}/ dp^m \mathbb{Z})^{\times}$ to $(\mathbb{Z}/ d \mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times}$ via the restriction map. \\

By construction, the last term given as input to \lean{integral} has type \newline \lean{C((units (zmod d) √ó units $\mathbb{Z}$\_[p]),R)}. 
This is the term in angular brackets \lean{‚ü®\_, \_‚ü©}, the former is the integrand, and the latter is a proof that the integrand is continuous : 

\begin{lstlisting}
  lemma cont_paLf : continuous (Œª (a : (units (zmod d) √ó units ‚Ñ§_[p])),
  ((pri_dir_char_extend p d R) a) * (inj (Teichm√ºller_character p (a.snd)))^(p - 2)
  * (w.to_fun a : R))
\end{lstlisting}

What remains to be proved is that $f$ is invariant with respect to $c$. 
Once these are proved, we can formalise properties of $p$-adic $L$-functions. One of the most
important properties is, for an integer $n$ with $n \ge 1$,
$$ L_p (1 - n, \chi) = -(1 - \chi \omega^{-n}(p)p^{n - 1}) \frac{B_{n, \chi \omega^{-n}}}{n} $$
Recall that the function corresponding to $1 - n$ is $<a>^{1 - n}$. One must show that $<a>^{1 - n}$ is 
an element of the weight space. formalising the first definition would have made showing this result a 
lot tougher, since showing the analytic continuation of these functions is nontrivial, even on paper.

\section{Evaluation at negative integers}
We shall now prove that our chosen definition of the $p$-adic $L$-function is equivalent to the original one, that is, 
it takes the same values at negative integers : for $n > 1$,
$$ L_p (1 - n, \chi) = -(1 - \chi \omega^{-n}(p)p^{n - 1}) \frac{B_{n, \chi \omega^{-n}}}{n} $$
For this section, we assume that $R$ is a normed commutative $\mathbb{Q}_p$-algebra and $\mathbb{Q}$-algebra, 
which is complete, nontrivial, and has no zero divisors. The scalar multiplication structure obtained from $\mathbb{Q}$ 
and $\mathbb{Q}_p$ are compatible, given by the condition \lean{is\_scalar\_tower ‚Ñö ‚Ñö\_[p] R} (see \cite{DD}). It is also non-archimedean, which are encapsulated by the following hypotheses:
\begin{lstlisting}
  na : ‚àÄ (n : ‚Ñï) (f : ‚Ñï ‚Üí R), 
    ‚à•‚àë (i : ‚Ñï) in finset.range n, f i‚à• ‚â§ ‚®Ü (i : zmod n), ‚à•f i.val‚à•
  na' : ‚àÄ (n : ‚Ñï) (f : (zmod n)À£ ‚Üí R), 
    ‚à•‚àë i : (zmod n)À£, f i‚à• ‚â§ ‚®Ü (i : (zmod n)À£), ‚à•f i‚à•
\end{lstlisting}
The prime $p$ is odd, and we choose positive natural numbers $d$ and $c$ which are mutually coprime and are also coprime to 
$p$. The Dirichlet character $\chi$ has level $d p^m$, where $m$ is positive. We also assume $\chi$ is even and $d$ divides 
its conductor. Let us first explain why we need the latter condition.

\subsection{Factors of the conductor}
We explain here why we need $d$ to divide the conductor of $\chi$. In this section, we do not differentiate between the associated Dirichlet 
character and the Dirichlet character. \\

Recall that $\chi \omega^{-1}$ actually denotes the Dirichlet 
character multiplication of $\chi$ and $\omega^{-1}$. As mentioned in the previous section, in order to translate between sums on 
$\mathbb{Z}/ d p^n \mathbb{Z} ^{\times}$ and $\mathbb{Z}/ d p^n \mathbb{Z}$, one needs that, for all $x \in \mathbb{Z}/ d p^n \mathbb{Z}$ 
such that $x$ is not a unit, $\chi \omega^{-k} (x) = 0$ for all $k > 0$. This is equivalent to saying, $\forall y \in \mathbb{N}$, such that 
$gcd (y, d) \ne 1$ and $gcd (y, p) \ne 1$, $gcd (y, (\chi \omega^{-k})\texttt{.conductor}) \ne 1$. \\

Given coprime natural numbers $k_1, k_2$ and a Dirichlet character $\psi$ of level $k_1 k_2$, one can find primitive Dirichlet characters 
$\psi_1$ and $\psi_2$ of levels $k_1$ and $k_2$ respectively such that $\psi = \psi_1 \psi_2$ : 
\begin{lstlisting}
  lemma dirichlet_character.eq_mul_of_coprime_of_dvd_conductor {m n : ‚Ñï} 
  [fact (0 < m * n)] (œá : dirichlet_character R (m * n)) (hœá : m | œá.conductor) 
  (hcop : m.coprime n) : ‚àÉ (œá‚ÇÅ : dirichlet_character R m) 
  (œá‚ÇÇ : dirichlet_character R n), œá‚ÇÅ.is_primitive ‚àß 
  œá = œá‚ÇÅ.change_level (dvd_mul_right m n) * œá‚ÇÇ.change_level (dvd_mul_left n m) 
\end{lstlisting}

Thus, given $k > 0$, we can find primitive Dirichlet characters $\chi_1$ and $\chi_2$ with conductors $z_1$ and $z_2$ such that 
$z_1 | d$ and $z_2 | p^m$ and $\chi_1 \chi_2 = \chi \omega^{-k}$. The condition that $d$ divides the conductor of $\chi$ ensures 
that $z_1 = d$. As a result, if $gcd (y, d) \ne 1$, then $gcd (y, z_1 z_2) \ne 1$, so $\chi \omega^{-k} (y) = 0$.

\subsection{Main Result}
Note that the same result holds when $\chi$ is odd or when $p = 2$, the proofs differ slightly. We shall 
skip most of the details of the proof, since these are very calculation intensive. We shall instead highlight the key concepts 
that are used. \\

The proof consists of two steps : breaking up the integral in the LHS into three sums, 
and evaluating each of these sums. This is very calculation intensive, and was the longest part of the project. 
The proof is very similar to the proof of Theorem 12.2 in \cite{cyc}. 

%\subsection{Breaking up into three sums}
Using the fact that the space of locally constant functions is dense in $C((\mathbb{Z}/d \mathbb{Z})^{\times} \times \mathbb{Z}_p^{\times}, R)$, 
we observe that the integral $L_p (1 - n, \chi)$ is the same as :
$$ L_p (1 - n, \chi) = \lim_{j \to \infty} \sum_{a \in (\mathbb{Z}/ d p^j \mathbb{Z})^{\times}} E_{c, j} (\chi \omega^{-1} (a) <a>^{n - 1}) \label{eqn:1} $$
$$ = \lim_{j \to \infty} \bigg ( \sum_{a \in (\mathbb{Z}/ d p^j \mathbb{Z})^{\times}} \chi \omega^{-n} a^{n - 1} \bigg \{ \frac{a}{d p^j} \bigg \} - 
  \sum_{a \in (\mathbb{Z}/ d p^j \mathbb{Z})^{\times}} \chi \omega^{-n} a^{n - 1} \bigg ( c \bigg \{ \frac{c^{-1} a}{d p^j} \bigg \} \bigg ) 
  + \bigg ( \frac{c - 1}{2} \bigg ) \sum_{a \in (\mathbb{Z}/ d p^j \mathbb{Z})^{\times}} \chi \omega^{-n} a^{n - 1} \bigg ) $$

Going from the first equation to the second took about 600 lines of code, which can be found in \lean{try.lean} (add link). While the proof (on paper) is only a page long, 
this is very calculation heavy in Lean, because one needs to shift between elements coerced to different types, such as $\mathbb{Z}/ (d p^j) \mathbb{Z}$, 
$\mathbb{Z}/ d \mathbb{Z} \times \mathbb{Z}/ p^j \mathbb{Z}$, $\mathbb{Z}/ d \mathbb{Z} \times \mathbb{Z}_p$, $R$ and their units. Moreover, when each of these types occur 
as locally constant or continuous functions, one needs to separately prove that each of these functions 
is also (respectively) locally constant or continuous. Some other difficulties include several different ways to write obtain the same term, such as \lean{equiv.inv\_fun}, 
\lean{equiv.symm}, \lean{ring\_equiv.symm} and \lean{ring\_equiv.to\_equiv.inv\_fun}. We have constructed several lemmas to simplify traversing between these terms. \\

Each of these sums are then evaluated separately in \lean{UVW.lean}. This is dependent on the following lemma : 
$$ \lim_{j \to \infty} \frac{1}{d p^j} \sum_{i \in \mathbb{Z}/ d p^j \mathbb{Z}} \chi \omega^{-n} (i) i^n = B_{n, \chi \omega^{-n}} $$ 
for $n > 1$. There were two options for the \lean{finset} used in \lean{finset.sum} : \lean{finset.range} or \lean{zmod (d * p\textasciicircum j)}. 
We chose the former since it was easier to deal with, as some required lemmas regarding it had been previously formalised. This lemma is 
formulated in Lean as :
\begin{lstlisting}
  tendsto (Œª (n : ‚Ñï), (1 / ‚Üë(d * p ^ n)) ‚Ä¢ ‚àë (i : ‚Ñï) in finset.range (d * p ^ n),
  (asso_dirichlet_character (œá.mul (teichmuller_character_mod_p' p R ^ k))) ‚Üëi * 
  ‚Üëi ^ k) at_top
  (nhds (general_bernoulli_number (œá.mul (teichmuller_character_mod_p' p R ^ k)) k))
\end{lstlisting}

The proof of this theorem follows from the proof in Lemma 7.11 of \cite{cyc}. It is very calculation intensive, since there are multiple 
coercions to be dealt with. Also, terms needs to be moved around to be multiplied, deleted and cancelled. Unfortunately, there is no tactic 
that takes care of these elementary but lengthy calculations. \\

This is similar to what we need to compute the first sum in \eqref{eqn:1} :
\begin{lstlisting}
  tendsto (Œª (j : ‚Ñï), ‚àë (x : (zmod (d * p ^ j))À£),
  ((asso_dirichlet_character (œá.mul (teichmuller_character_mod_p' p R ^ n))) ‚Üëx *
  ‚Üë(‚Üëx.val) ^ (n - 1)) ‚Ä¢ (algebra_map ‚Ñö R) (int.fract (‚Üëx / (‚Üëd * ‚Üëp ^ j))))
  at_top
  (nhds ((1 - (asso_dirichlet_character (œá.mul (teichmuller_character_mod_p' p R ^ n))) ‚Üëp * ‚Üëp ^ (n - 1)) *
  general_bernoulli_number (œá.mul (teichmuller_character_mod_p' p R ^ n)) n))
\end{lstlisting}

In order to convert this sum into a sum over \lean{finset.range}, we show that :
\begin{lstlisting}
  lemma helper_U_3 (x : ‚Ñï) : finset.range (d * p^x) = 
  set.finite.to_finset (set.finite_of_finite_inter (finset.range (d * p^x)) 
  ({x | ¬¨ x.coprime d})) ‚à™ ((set.finite.to_finset (set.finite_of_finite_inter 
  (finset.range (d * p^x)) ({x | ¬¨ x.coprime p}))) ‚à™ set.finite.to_finset 
  (set.finite_of_finite_inter (finset.range (d * p^x)) 
  ({x | x.coprime d} ‚à© {x | x.coprime p}))) 
\end{lstlisting}

This is equivalent to saying :
$$ \mathbb{Z} / d p^k \mathbb{Z} \simeq \{ x \in \mathbb{N} | gcd (x, d) \ne 1 \} \cup \{ x \in \mathbb{N} | gcd (x, p) \ne 1 \} 
\cup (\mathbb{Z} / d p^k \mathbb{Z})^{\times} $$
The condition that $d$ divides the conductor is then used to show that the associated Dirichlet character is 0 everywhere except 
$(\mathbb{Z} / d p^k \mathbb{Z})^{\times}$. \\

Evaluating the middle sum is the most tedious. It is first broken into two sums, so that the previous result can be used. Then, a 
change of variable from $a$ to $c^{-1} a$ is applied. The variable $c$ is coerced to $\mathbb{Z}/ d p^{2k} \mathbb{Z}$, increasing 
the number of coercions significantly, thus lengthening the calculations. \\

Finally, the last sum is 0. This follows by substituting $a$ in the summand with $-a$. This is where one uses that $\chi$ is even. \\

There were two ways to do calculations with respect to inequalities on the norm : working with lemmas regarding \lean{filter.tendsto}, 
or using the following lemma : 
\begin{lstlisting}
  metric.tendsto_at_top : ‚àÄ {Œ± : Type u_1} {Œ≤ : Type} [pseudo_metric_space Œ±] 
  [nonempty Œ≤] [semilattice_sup Œ≤] {u : Œ≤ ‚Üí Œ±} {a : Œ±}, 
  tendsto u at_top (nhds a) ‚Üî ‚àÄ (Œµ : ‚Ñù), Œµ > 0 ‚Üí 
  (‚àÉ (N : Œ≤), ‚àÄ (n : Œ≤), n ‚â• N ‚Üí dist (u n) a < Œµ)
\end{lstlisting}
We would like to point out that working with \lean{filter.tendsto} instead of \lean{metric.tendsto\_at\_top} really simplified 
calculations. This is because, often, the \lean{Œµ} we would choose would be complicated, making our calculations more 
complicated. As an example, suppose we want to prove :
\begin{lstlisting}
  (h : filter.tendsto (Œª x, f x) at_top (nhds 0)) ‚Üí filter.tendsto (Œª x, c * f x) at_top (nhds 0)
\end{lstlisting}
This is a one-line proof using \lean{filter.tendsto\_const\_mul}. However, if done using \lean{metric.tendsto\_at\_top}, 
given $\varepsilon > 0$, we must pick an $N$ such that $\lVert f x \rVert < \varepsilon / c$, and use $N$ to complete the proof. 
Most of such issues can be dealt with using the lemma \lean{filter.tendsto\_congr'}. \\

Hence, we try to avoid using \lean{metric.tendsto\_at\_top} when possible. The only cases where it is used is when direct inequalities 
need to be dealt with; this happens precisely when the non-archimedean condition on $R$ needs to be used. Hence, this is a good 
indicator of where the non-Archimedean condition is needed.

\section{Conclusion}
\subsection{Analysis}
We list some of the observations that arose while working on this paper. \\
Throughout this paper, \lean{abbreviation} has played an important part. They help to reduce the number of \lean{def} for a prticular type. A technical 
difficulty is that one cannot use tactic \lean{rw} to unfold the underlying definition. One must either use \lean{delta}, which often slows compilation 
time, or make a lemma unfolding the \lean{abbreviation}. \\ 

The tactic \lean{rw} does not always work inside sums. As a result, one must use 
the \lean{conv} tactic to get to the expression inside the sum. While using the \lean{conv} tactic, one is said to be working 
in \lean{conv} mode. Using the \lean{conv} tactic not only lengthens the proof, but also limits the tactics one can use; the 
only tactics one can use inside \lean{conv} mode are \lean{rw}, \lean{apply\_congr}(similar to \lean{apply}), \lean{simp} and 
\lean{norm\_cast}. Another way around sums is to use \lean{simp\_rw}, however, this increases compilation time of the proof. 
Moreover, \lean{simp\_rw} rewrites the lemma as many times as applicable, and is an unsuitable choice if one wants to apply 
the lemma just once. \\

Another problem that was recurring was the ratio of implicit to explicit variables. The $p$-adic $L$-function, for example, has 19 arguments, of which 7 are explicit, and $p$, 
$d$ and $R$ are implicit. This is problematic because 7 is already a large number of hypotheses. Excluding $R$ often means that either Lean guesses or abstracts the correct term, 
or it asks for them explicitly. In the latter case, one also gets as additional goals all the hypotheses that are dependent on $R$ and implicit, such as \lean{normed\_comm\_ring R}. 
Moreover, one cannot get out of \lean{conv} mode unless all these goals are solved. This is difficult since \lean{apply\_instance} does not work in \lean{conv} mode. The other 
alternative is to explicitly provide terms using \lean{@}, however this leads to very large expressions. \\

Working with Dirichlet characters was challenging. This is because, given $a, b \in \mathbb{N}$ such that $a = b$, Lean does not identify 
\lean{dirichlet\_character R a = dirichlet\_character R b}. Tactics such as \lean{subst} also fail. A workaround was putting \lean{h:a = b} as a local hypothesis and then using 
\lean{congr'}. We then end up with the goal \lean{dirichlet\_character R a == dirichlet\_character R b}. The API for \lean{heq} suggests that this should be avoided as much as possible. 
Another workaround was to define and use \lean{dirichlet\_character R a ‚âÉ dirichlet\_character R b}. However, this would slow down the compilation a lot, sometimes also leading to 
deterministic timeouts. 

\subsection{Statistics}
When initially completed, this project consisted of around 18,000 lines of code. A major refactor was then done, keeping in mind several of the points mentioned above, specifically 
using properties of filters instead of metric space calculations wherever possible. All properties regarding particular types (such as Dirichlet characters) were also compiled together 
in separate files wherever possible. Keeping in mind the spirit of \lean{mathlib}, these properties have been made in the greatest generality as much as possible. 
After the refactor, there are about 15000 lines of code, put into 10 files (check!). \\

While most properties regarding Bernoulli numbers and polynomials have been put into \lean{mathlib}, the rest of the work is on a private repository. The author hopes to push the 
work directly to Lean 4, once the required port is complete.

\subsection{Related and future work} % some error occurs if I remove the *
There are several projects that require Dirichlet characters and properties of the $p$-adic integers. These include the project on the formalisation of Fermat's last theorem (link). 
There is also an effort by Prof David Loeffler which involves formalisation of the classical Dirichlet $L$-function, that is somewhat dependent on this work. \\

In the future, the author hopes to be able to work on Iwasawa theory, for which the $p$-adic $L$-function is a key ingredient. She also hopes to formalise more properties of Bernoulli numbers, 
that are a fundamental component of number theory.

\bibliography{ITP-2023}

\section{Typesetting instructions -- Summary}
\label{sec:typesetting-summary}

LIPIcs is a series of open access high-quality conference proceedings across all fields in informatics established in cooperation with Schloss Dagstuhl. 
In order to do justice to the high scientific quality of the conferences that publish their proceedings in the LIPIcs series, which is ensured by the thorough review process of the respective events, we believe that LIPIcs proceedings must have an attractive and consistent layout matching the standard of the series.
Moreover, the quality of the metadata, the typesetting and the layout must also meet the requirements of other external parties such as indexing service, DOI registry, funding agencies, among others. The guidelines contained in this document serve as the baseline for the authors, editors, and the publisher to create documents that meet as many different requirements as possible. 

Please comply with the following instructions when preparing your article for a LIPIcs proceedings volume. 
\paragraph*{Minimum requirements}

\begin{itemize}
\item Use pdflatex and an up-to-date \LaTeX{} system.
\item Use further \LaTeX{} packages and custom made macros carefully and only if required.
\item Use the provided sectioning macros: \verb+\section+, \verb+\subsection+, \verb+\subsubsection+, \linebreak \verb+\paragraph+, \verb+\paragraph*+, and \verb+\subparagraph*+.
\item Provide suitable graphics of at least 300dpi (preferably in PDF format).
\item Use BibTeX and keep the standard style (\verb+plainurl+) for the bibliography.
\item Please try to keep the warnings log as small as possible. Avoid overfull \verb+\hboxes+ and any kind of warnings/errors with the referenced BibTeX entries.
\item Use a spellchecker to correct typos.
\end{itemize}

\paragraph*{Mandatory metadata macros}
Please set the values of the metadata macros carefully since the information parsed from these macros will be passed to publication servers, catalogues and search engines.
Avoid placing macros inside the metadata macros. The following metadata macros/environments are mandatory:
\begin{itemize}
\item \verb+\title+ and, in case of long titles, \verb+\titlerunning+.
\item \verb+\author+, one for each author, even if two or more authors have the same affiliation.
\item \verb+\authorrunning+ and \verb+\Copyright+ (concatenated author names)\\
The \verb+\author+ macros and the \verb+\Copyright+ macro should contain full author names (especially with regard to the first name), while \verb+\authorrunning+ should contain abbreviated first names.
\item \verb+\ccsdesc+ (ACM classification, see \url{https://www.acm.org/publications/class-2012}).
\item \verb+\keywords+ (a comma-separated list of keywords).
\item \verb+\relatedversion+ (if there is a related version, typically the ``full version''); please make sure to provide a persistent URL, e.\,g., at arXiv.
\item \verb+\begin{abstract}...\end{abstract}+ .
\end{itemize}

\paragraph*{Please do not \ldots} %Do not override the \texttt{\seriesstyle}-defaults}
Generally speaking, please do not override the \texttt{lipics-v2021}-style defaults. To be more specific, a short checklist also used by Dagstuhl Publishing during the final typesetting is given below.
In case of \textbf{non-compliance} with these rules Dagstuhl Publishing will remove the corresponding parts of \LaTeX{} code and \textbf{replace it with the \texttt{lipics-v2021} defaults}. In serious cases, we may reject the LaTeX-source and expect the corresponding author to revise the relevant parts.
\begin{itemize}
\item Do not use a different main font. (For example, the \texttt{times} package is forbidden.)
\item Do not alter the spacing of the \texttt{lipics-v2021.cls} style file.
\item Do not use \verb+enumitem+ and \verb+paralist+. (The \texttt{enumerate} package is preloaded, so you can use
 \verb+\begin{enumerate}[(a)]+ or the like.)
\item Do not use ``self-made'' sectioning commands (e.\,g., \verb+\noindent{\bf My+ \verb+Paragraph}+).
\item Do not hide large text blocks using comments or \verb+\iffalse+ $\ldots$ \verb+\fi+ constructions. 
\item Do not use conditional structures to include/exclude content. Instead, please provide only the content that should be published -- in one file -- and nothing else.
\item Do not wrap figures and tables with text. In particular, the package \texttt{wrapfig} is not supported.
\item Do not change the bibliography style. In particular, do not use author-year citations. (The
\texttt{natbib} package is not supported.)
\end{itemize}

\enlargethispage{\baselineskip}

This is only a summary containing the most relevant details. Please read the complete document ``LIPIcs: Instructions for Authors and the \texttt{lipics-v2021} Class'' for all details and don't hesitate to contact Dagstuhl Publishing (\url{mailto:publishing@dagstuhl.de}) in case of questions or comments:
\href{http://drops.dagstuhl.de/styles/lipics-v2021/lipics-v2021-authors/lipics-v2021-authors-guidelines.pdf}{\texttt{http://drops.dagstuhl.de/styles/lipics-v2021/\newline lipics-v2021-authors/lipics-v2021-authors-guidelines.pdf}}

\section{Lorem ipsum dolor sit amet}

Lorem ipsum dolor sit amet, consectetur adipiscing elit \cite{DBLP:journals/cacm/Knuth74}. Praesent convallis orci arcu, eu mollis dolor. Aliquam eleifend suscipit lacinia. Maecenas quam mi, porta ut lacinia sed, convallis ac dui. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. Donec eget odio et magna ullamcorper vehicula ut vitae libero. Maecenas lectus nulla, auctor nec varius ac, ultricies et turpis. Pellentesque id ante erat. In hac habitasse platea dictumst. Curabitur a scelerisque odio. Pellentesque elit risus, posuere quis elementum at, pellentesque ut diam. Quisque aliquam libero id mi imperdiet quis convallis turpis eleifend. 

\begin{lemma}[Lorem ipsum]
\label{lemma:lorem}
Vestibulum sodales dolor et dui cursus iaculis. Nullam ullamcorper purus vel turpis lobortis eu tempus lorem semper. Proin facilisis gravida rutrum. Etiam sed sollicitudin lorem. Proin pellentesque risus at elit hendrerit pharetra. Integer at turpis varius libero rhoncus fermentum vitae vitae metus.
\end{lemma}

\begin{proof}
Cras purus lorem, pulvinar et fermentum sagittis, suscipit quis magna.


\proofsubparagraph*{Just some paragraph within the proof.}
Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
\begin{claim}
content...
\end{claim}
\begin{claimproof}
content...
    \begin{enumerate}
        \item abc abc abc \claimqedhere{}
    \end{enumerate}
\end{claimproof}

\end{proof}

\begin{corollary}[Curabitur pulvinar, \cite{DBLP:books/mk/GrayR93}]
\label{lemma:curabitur}
Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
\end{corollary}

\begin{proposition}\label{prop1}
This is a proposition
\end{proposition}

\autoref{prop1} and \cref{prop1} \ldots

\subsection{Curabitur dictum felis id sapien}

Curabitur dictum \cref{lemma:curabitur} felis id sapien \autoref{lemma:curabitur} mollis ut venenatis tortor feugiat. Curabitur sed velit diam. Integer aliquam, nunc ac egestas lacinia, nibh est vehicula nibh, ac auctor velit tellus non arcu. Vestibulum lacinia ipsum vitae nisi ultrices eget gravida turpis laoreet. Duis rutrum dapibus ornare. Nulla vehicula vulputate iaculis. Proin a consequat neque. Donec ut rutrum urna. Morbi scelerisque turpis sed elit sagittis eu scelerisque quam condimentum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aenean nec faucibus leo. Cras ut nisl odio, non tincidunt lorem. Integer purus ligula, venenatis et convallis lacinia, scelerisque at erat. Fusce risus libero, convallis at fermentum in, dignissim sed sem. Ut dapibus orci vitae nisl viverra nec adipiscing tortor condimentum \cite{DBLP:journals/cacm/Dijkstra68a}. Donec non suscipit lorem. Nam sit amet enim vitae nisl accumsan pretium. 

\begin{lstlisting}[caption={Useless code.},label=list:8-6,captionpos=t,float,abovecaptionskip=-\medskipamount]
for i:=maxint to 0 do 
begin 
    j:=square(root(i));
end;
\end{lstlisting}

\subsection{Proin ac fermentum augue}

Proin ac fermentum augue. Nullam bibendum enim sollicitudin tellus egestas lacinia euismod orci mollis. Nulla facilisi. Vivamus volutpat venenatis sapien, vitae feugiat arcu fringilla ac. Mauris sapien tortor, sagittis eget auctor at, vulputate pharetra magna. Sed congue, dui nec vulputate convallis, sem nunc adipiscing dui, vel venenatis mauris sem in dui. Praesent a pretium quam. Mauris non mauris sit amet eros rutrum aliquam id ut sapien. Nulla aliquet fringilla sagittis. Pellentesque eu metus posuere nunc tincidunt dignissim in tempor dolor. Nulla cursus aliquet enim. Cras sapien risus, accumsan eu cursus ut, commodo vel velit. Praesent aliquet consectetur ligula, vitae iaculis ligula interdum vel. Integer faucibus faucibus felis. 

\begin{itemize}
\item Ut vitae diam augue. 
\item Integer lacus ante, pellentesque sed sollicitudin et, pulvinar adipiscing sem. 
\item Maecenas facilisis, leo quis tincidunt egestas, magna ipsum condimentum orci, vitae facilisis nibh turpis et elit. 
\end{itemize}

\begin{remark}
content...
\end{remark}

\section{Pellentesque quis tortor}

Nec urna malesuada sollicitudin. Nulla facilisi. Vivamus aliquam tempus ligula eget ornare. Praesent eget magna ut turpis mattis cursus. Aliquam vel condimentum orci. Nunc congue, libero in gravida convallis \cite{DBLP:conf/focs/HopcroftPV75}, orci nibh sodales quam, id egestas felis mi nec nisi. Suspendisse tincidunt, est ac vestibulum posuere, justo odio bibendum urna, rutrum bibendum dolor sem nec tellus. 

\begin{lemma} [Quisque blandit tempus nunc]
Sed interdum nisl pretium non. Mauris sodales consequat risus vel consectetur. Aliquam erat volutpat. Nunc sed sapien ligula. Proin faucibus sapien luctus nisl feugiat convallis faucibus elit cursus. Nunc vestibulum nunc ac massa pretium pharetra. Nulla facilisis turpis id augue venenatis blandit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.
\end{lemma}

Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.

\section{Morbi eros magna}

Morbi eros magna, vestibulum non posuere non, porta eu quam. Maecenas vitae orci risus, eget imperdiet mauris. Donec massa mauris, pellentesque vel lobortis eu, molestie ac turpis. Sed condimentum convallis dolor, a dignissim est ultrices eu. Donec consectetur volutpat eros, et ornare dui ultricies id. Vivamus eu augue eget dolor euismod ultrices et sit amet nisi. Vivamus malesuada leo ac leo ullamcorper tempor. Donec justo mi, tempor vitae aliquet non, faucibus eu lacus. Donec dictum gravida neque, non porta turpis imperdiet eget. Curabitur quis euismod ligula. 


%%
%% Bibliography
%%

%% Please use bibtex, 

\appendix

\section{Styles of lists, enumerations, and descriptions}\label{sec:itemStyles}

List of different predefined enumeration styles:

\begin{itemize}
\item \verb|\begin{itemize}...\end{itemize}|
\item \dots
\item \dots
%\item \dots
\end{itemize}

\begin{enumerate}
\item \verb|\begin{enumerate}...\end{enumerate}|
\item \dots
\item \dots
%\item \dots
\end{enumerate}

\begin{alphaenumerate}
\item \verb|\begin{alphaenumerate}...\end{alphaenumerate}|
\item \dots
\item \dots
%\item \dots
\end{alphaenumerate}

\begin{romanenumerate}
\item \verb|\begin{romanenumerate}...\end{romanenumerate}|
\item \dots
\item \dots
%\item \dots
\end{romanenumerate}

\begin{bracketenumerate}
\item \verb|\begin{bracketenumerate}...\end{bracketenumerate}|
\item \dots
\item \dots
%\item \dots
\end{bracketenumerate}

\begin{description}
\item[Description 1] \verb|\begin{description} \item[Description 1]  ...\end{description}|
\item[Description 2] Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\item[Description 3]  \dots
%\item \dots
\end{description}

\cref{testenv-proposition} and \autoref{testenv-proposition} ...

\section{Theorem-like environments}\label{sec:theorem-environments}

List of different predefined enumeration styles:

\begin{theorem}\label{testenv-theorem}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{theorem}

\begin{lemma}\label{testenv-lemma}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{lemma}

\begin{corollary}\label{testenv-corollary}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{corollary}

\begin{proposition}\label{testenv-proposition}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{proposition}

\begin{conjecture}\label{testenv-conjecture}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{conjecture}

\begin{observation}\label{testenv-observation}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{observation}

\begin{exercise}\label{testenv-exercise}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{exercise}

\begin{definition}\label{testenv-definition}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{definition}

\begin{example}\label{testenv-example}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{example}

\begin{note}\label{testenv-note}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{note}

\begin{note*}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{note*}

\begin{remark}\label{testenv-remark}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{remark}

\begin{remark*}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{remark*}

\begin{claim}\label{testenv-claim}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claim}

\begin{claim*}\label{testenv-claim2}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claim*}

\begin{proof}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{proof}

\begin{claimproof}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claimproof}

%\bibliography{ESAbib.bib}

\end{document}
